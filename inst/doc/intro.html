<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19020" />

<meta name="date" content="2020-01-02" />

<title>Introduction to SC19020</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SC19020</h1>
<h4 class="author">19020</h4>
<h4 class="date">2020-01-02</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>SC19020</strong> is a simple R package developed to calculate two important concepts in the “Non-parametric statistic” course and “Statistic computing” course. Bootstrap is a very important resampling method in Statistic and will be of great help for us to study the properties of the given data especially when sample size is not large. The kernel density estimator(KDE) is a very important non-parametric method to estimate the true density function of a given set of data when we know little about the true distribution of the data, and with KDE, we can study many other relevant concepts of the given data. In this package, two functions are considered, namely, <em>bootstrapR</em> (generate bootstraping samples of the given data) and <em>KDER</em> (compute the kernel density estimator of the given data).</p>
</div>
<div id="bootstrapr" class="section level2">
<h2><em>bootstrapR</em></h2>
<p>The source R code for <em>bootstrapR</em> is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>bootstrapR &lt;-<span class="st"> </span><span class="cf">function</span>(X, n) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  m &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb1-3"><a href="#cb1-3"></a>  out &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> n, <span class="dt">ncol =</span> m)</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb1-5"><a href="#cb1-5"></a>    out[i,] &lt;-<span class="st"> </span><span class="kw">sample</span>(X, m, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a>  }</span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="kw">return</span>(out)</span>
<span id="cb1-8"><a href="#cb1-8"></a>}</span></code></pre></div>
<p>In order to show how to use <em>bootstapR</em>, we give an example.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(SC19020)</span>
<span id="cb2-2"><a href="#cb2-2"></a>X &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">96</span>,<span class="dv">87</span>,<span class="dv">88</span>,<span class="dv">90</span>,<span class="dv">85</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>outer &lt;-<span class="st"> </span><span class="kw">bootstrapR</span>(X, <span class="dv">5</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a>outer</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]   87   85   85   90   90
## [2,]   96   90   85   87   85
## [3,]   96   90   88   96   96
## [4,]   88   88   90   90   96
## [5,]   90   87   90   88   90</code></pre>
</div>
<div id="kder" class="section level2">
<h2><em>KDER</em></h2>
<p>The source R code for <em>KDER</em> is as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>KDER &lt;-<span class="st"> </span><span class="cf">function</span>(X, h, x) {</span>
<span id="cb4-2"><a href="#cb4-2"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb4-3"><a href="#cb4-3"></a>  out &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>h)<span class="op">*</span><span class="kw">mean</span>(<span class="kw">dnorm</span>((x<span class="op">-</span>X)<span class="op">/</span>h))</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="kw">return</span>(out)</span>
<span id="cb4-5"><a href="#cb4-5"></a>}</span></code></pre></div>
<p>In order to show how to use <em>KDER</em>, we give an example.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>h &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>y &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){</span>
<span id="cb5-6"><a href="#cb5-6"></a>  y[i] &lt;-<span class="st"> </span><span class="kw">KDER</span>(X, h, x[i])</span>
<span id="cb5-7"><a href="#cb5-7"></a>}</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="kw">plot</span>(x, y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="homework-of-20190920" class="section level3">
<h3>Homework of 20190920</h3>
</div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to porduce at least 3 examples(texts, figures, tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>1.figure</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>x&lt;-<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">45</span>,<span class="dv">60</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>y&lt;-<span class="kw">c</span>(<span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">27</span>,<span class="dv">40</span>,<span class="dv">60</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">plot</span>(x,y,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">title</span>(<span class="dt">main=</span><span class="st">&quot;An example&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>2.table</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>math&lt;-<span class="kw">c</span>(<span class="dv">95</span>,<span class="dv">80</span>,<span class="dv">74</span>,<span class="dv">66</span>,<span class="dv">84</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>engl&lt;-<span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">77</span>,<span class="dv">68</span>,<span class="dv">92</span>,<span class="dv">85</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>phys&lt;-<span class="kw">c</span>(<span class="dv">90</span>,<span class="dv">82</span>,<span class="dv">65</span>,<span class="dv">74</span>,<span class="dv">90</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>chem&lt;-<span class="kw">c</span>(<span class="dv">88</span>,<span class="dv">96</span>,<span class="dv">70</span>,<span class="dv">84</span>,<span class="dv">80</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>mydata&lt;-<span class="kw">data.frame</span>(math,engl,phys,chem)</span>
<span id="cb7-6"><a href="#cb7-6"></a>mydata</span></code></pre></div>
<pre><code>##   math engl phys chem
## 1   95   80   90   88
## 2   80   77   82   96
## 3   74   68   65   70
## 4   66   92   74   84
## 5   84   85   90   80</code></pre>
<p>3.text</p>
<p>We derive the nonparametric maximum likelihood estimate, <span class="math inline">\(\hat{F}\)</span> say, of a lifetime distribution <span class="math inline">\(\boldsymbol{F}\)</span> on the basis of two independent samples, one a sample of size <span class="math inline">\(m\)</span> from <span class="math inline">\(\boldsymbol{F}\)</span> and the other a sample of size <span class="math inline">\(n\)</span> from the length-biased distribution of <span class="math inline">\(\boldsymbol{F}\)</span>, i.e.from <span class="math inline">\(G_{F}(y) \equiv G(y)=\frac{1}{\mu} \int_{0}^{y} x d F(x),\quad y\geq 0\)</span>. We further show that <span class="math inline">\((m+n)^{1 / 2}(\hat{F}-F)\)</span> converges weakly to a pinned Gaussian process with a simple covariance function, when <span class="math inline">\(m+n \rightarrow \infty\)</span> and <span class="math inline">\(m / n \rightarrow\)</span> constant.</p>
<div id="homework-of-20190929" class="section level3">
<h3>Homework of 20190929</h3>
</div>
</div>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>3.4 The Rayleigh density [156, Ch. 18] is <span class="math inline">\(f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0\)</span>. Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma&gt;0\)</span> and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span> (check the histogram).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>1.basic ideas</p>
<p>采用The inverse transform method，可以求出Rayleigh distribution 的cdf,即<span class="math inline">\(F(x)=1-e^{-\frac{x^{2}}{2 \sigma^{2}}}\)</span>，先从均匀U(0,1)分布中生成随机样本，再反解出x=<span class="math inline">\(F_{x}^{-1}(U)\)</span>，从而样本x服从于Rayleigh distribution</p>
<p>2.code</p>
<p>(1)take sigma as 1</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span>;n &lt;-<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb9-3"><a href="#cb9-3"></a>x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)) <span class="co"># F(x) = 1-exp(-x^2/(2*sigma^2)), x&gt;=0,sigma&gt;0</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw">hist</span>(x,<span class="dt">prob =</span><span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb9-5"><a href="#cb9-5"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="fl">.01</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw">lines</span>(y, y<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>))))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(2)take sigma as 2</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span>; n &lt;-<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb10-3"><a href="#cb10-3"></a>x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)) <span class="co"># F(x) = 1-exp(-x^2/(2*sigma^2)), x&gt;=0,sigma&gt;0</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="kw">hist</span>(x,<span class="dt">prob =</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">8</span>), <span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span><span class="dv">4</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">8</span>)))</span>
<span id="cb10-5"><a href="#cb10-5"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="fl">0.01</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw">lines</span>(y, y<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>))))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.my thoughts</p>
<p>The inverse transform method performs well in generating samples from complicated distributions but with inverse function of its cdf.</p>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>3.11 Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0,1)\)</span>and <span class="math inline">\(N(3,1)\)</span>distributions with mixing probabilities <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}=1-p_{1}\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_{1}=0.75\)</span>. Repeat with different values for <span class="math inline">\(p_{1}\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_{1}\)</span> that produce bimodal mixtures.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>1.basic ideas</p>
<p>利用课件上的方法，生成随机样本，再比较样本的频率分布直方图和总体密度曲线的拟合程度</p>
<p>2.code</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>X1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a>X2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>) </span>
<span id="cb11-4"><a href="#cb11-4"></a>r &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>))</span>
<span id="cb11-5"><a href="#cb11-5"></a>Z &lt;-<span class="st"> </span>r<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>X2</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="kw">hist</span>(Z,<span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="dv">100</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">6</span>))</span>
<span id="cb11-7"><a href="#cb11-7"></a>x&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">6</span>,<span class="fl">0.01</span>)</span>
<span id="cb11-8"><a href="#cb11-8"></a>y&lt;-<span class="fl">0.75</span><span class="op">*</span><span class="kw">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span><span class="fl">0.25</span><span class="op">*</span><span class="kw">dnorm</span>(x,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="kw">lines</span>(x,y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>){</span>
<span id="cb12-5"><a href="#cb12-5"></a>  X1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>  X2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>) </span>
<span id="cb12-7"><a href="#cb12-7"></a>  r &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">size=</span>n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(p[i],<span class="dv">1</span><span class="op">-</span>p[i]))</span>
<span id="cb12-8"><a href="#cb12-8"></a>  Z&lt;-<span class="st"> </span>r<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>X2</span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="kw">hist</span>(Z,<span class="dt">breaks =</span> <span class="dv">100</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">6</span>))</span>
<span id="cb12-10"><a href="#cb12-10"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///8ufgoAAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJqklEQVR4nO2da2PbJhiFSZcsXrpLsnRrs3vcbdnUy+Ik9v//aRMgbDkWHDAgkHKeD60TSUg8eUEIARYb4kSUvoDaoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggDZBa1vxNm9/v98+0Nv85//pj7h+4UQ38pPT1ei493xyRUW9Hj9KrWglTRyKT9NUNABS5FcUCNObvWnCQrqfvhwIcTJN3fST4tU9OmNEF/8oIJr/V6I01tlrs3rb9fi1d3m03W73+tblefzTxfi5O3mw6Lda3eabQIqyZPelpWI+iOUENToP2t72UZQ9xu5Y7uLzOHF7tdn9yu9uc32NigujFrNLoHngh4We7qCGUOQoRMko+B+81FVFLqItZnQ3i7VH/z8fr003s7uNv+1R315L3e6VIIu5bHibbe/op9Asyek3RJTwIoIaq/59O9uqxbU1URLHVTycytCCzKZ+/zXhUyg/X1rQv+rjPWT2ZhyuROkhcZQQJD+ja5xVJZMKZRZM5/38rr+2SQgo2/T/bsT1E9gT5A81cCtIYQSddDjta5S/ug86Pyq0vXOfO4Lktk8/fXzlVVQP4E9QUvxvN0VTJl20OMvF6ZK9YggbeLJLsgWQU3cDUxRrKG4/mlX49jrIJVXFRjbSnpAkKUOWom4G5iigKD2ur9T5UzdeGQW7HcxE0Fn94839jpo+C62V/sdTYkIer9t1qjnAlc7aFsHOSvpfjtoDoI2H2UN9Ppu0zWb77qG8I/6gPZXX98d3MVOf2/aX9kE9RKYmqAjWUbffhJRnaCl6qtooyOy/ZKK6gR1z10J7j9pqE7Q5vHNonvWr4L6BFUGBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggD1ChKiimsLuwgzLjL5JK8BRB1/vKCLaMyw0lXkDBEH27iZoKD1zW5ccp4xqK2dKQt6utrOvFrlKWSq/JrP0xPECEI0Zn5bnjpIhc+kBW2njGaKn10EaVc5ThJKFRfR0Re0oaBDJi/o6UrWPKtsDUUjyNRF0xSk7l+9G37SazFiJiyoU5PlNr8fPhMV9LBQgp41FLcz16Ly9BIiaMaCzNxzB7oVdL4x1bUrueOupWZBemIsaiC3jk5uHQ3pWQva+DkKSC7kQDEJQVpRRCsnRpA4EFRDp+LeFcg24Lv2od16D29Etx5LY5GYWFAFQbS7AlkFazPWzp5GLXEka+kXKOjpCs4z1v1BKsAyCBKVC/LAPGAsz+5fYASpfLt7wrY9isvzlyhoqSogXcVYMFr04jXu5EKvwyao9I2sVwfp8uPsjjd9ruublyfIlB9b4QlMLvhAi6DiTaHd6XV0PCyKtaQrjyC95GDsmiKzFlQ0OQpCB9YvKGbkRnyP4gQELVO8qpixIGsn4XHJBR9oF1RW0UFDMVFywQc6IqgOQeubFKuqzVhQ+5yaIIRmLGi71nddjxr1CCqcHAW5DtqzMyCo5I2sd2a1EPqywALn+0qGBBUMol4lfXLbyBX5x3+an4Yg2R/UOLrjA5MLO0iI+gXJhqIUFDfA9wVE0DJq5M+MBXV1UDP213R041knIEg3FUfvUTxQUq+gMslREDxiIoKinsUiehRjBeVuZT9PPXIaTwFBmaPrIPVlVLfQCxA0ckPxUMmwIGvCowsa+VHDW5BN0diCnKM7wpPDB3hHUGlBXlPB4LuznIKGY2j0IuYCz3rOGkHVC/KYszqiIF0tmbKXrTV02FC0lyCPWc+jCtqMKqh77eN6mq8tgvYFZVLU6w/SZlwzwfCs57yC9iQcRFBmQU/f644OZ0MR3uoyC9qVJDMt2vybX5CJoFF7FHezU/0FaUdiL4LMTxnY61Hc6NkGSZLz3H1CgnT5ccdP6obikYJ606LHFIRJ3VAczryPoCIRBEl+m08kKOs0+5BXz/aG4pE9iscI6k6zF0H9shd0AT7XuP2EXz3XF0EH74zSh1HQq+fUDcV4QYcfgy7A5xrNB69Xz4kbiqkF5aiIir56zhFBqauhoq+eswhKHERFXz1PTNDYyVmm8dYqqHcPt+HRpxYkaFoR5DPS3joT8zA5fGJbduMFJTXUq6Q9XojB4fgBgvJFUB5BfoMX0HD8GQsaOzkKgntOSVCyVe1mLcjjRu+ZnM+OFAR2zCkopaJZCkpZs6YRFNqjONDRNW9Bz5Lz2I2CwG6ZBaWrhowg+BgakpzHbrkFJQuiMg3FMQQlylkRQQky77FPGkUzFpQmbwUEDQ3poKDeLokyT0EpBMVXRCML8shjWkHRGRxd0PCrjDyCUrxqnXcEGUsZc5Q4uRKC4hy9DEH6uo7SFHZM5BjFfgU0siAhxhB0/BjF7cCwYhGk/w8n9xjFXU+abx6zCTpqlGCQoNAxiqJmcgjK/xV+FRJYB2X9Cr8qCSuReb/Cr0ryjL6eEVkEla1+ETUIitsetzn28Ljd0yRKQXHbKYiC4rZTEAXFbacgCorbPn9Bc4KCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBcglyLQGiBtHYXs2unKs/OA/1OLX8qtSw1XwzCVo5Xr6ub1oDjeU65VJzK6sh56Eep161mwLXO84jSC1mZdv4sFBLfg4OwtLjI6yrorsO9Ti1Tj1sxew8gpqzn9Dr++Ew8TBgO9Tj1A9fhS/dkkVQeyFwGaLhby3VWQCLQLi+8NR56tWrf65gFfaMHIJkJCNBlgE0OjicIeIce+M+dSMHVwZ+22UOQR4LWa0cdTQQZDvU49R6mdGwrzXIIEgVE7cgaxDgIuYcuwVOres2Xc/5klZQI1spTTfMZOAyGt2KaayZhJW0/VCTvuXUEi0+rKou0VB0rJMGbvPO9cDxqfUo1OJFTOEQ9LBwBIG7oeg81OPUsooKnNxdQFBXDiwWGtejhvtQfGr5IFPBbX5WUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggCVCzILFpVbz6lyQZrIL6COYgqCvAa95GICgtY3JVcEm4CgkgVsCoKKFrAJCCpbwCYgqGwBq19Q4Nyc9NQuyDUvYxQqF4S+lTM/lQtadkPny5WzygWVh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwP23ecBey7LqAAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///8ufgoAAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJiUlEQVR4nO2dC1vkJhhGcavVur1o3XbX3p1ta5u91FEn//+nNUCYyVzghQECie959nHHSSDh+AVIQohoiRNRegdqh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJkF7S6FWcP+v/z9S+DxX/+m3qD7y+E+FZ+er4WPe+Oz66woKebV6kFLaWRK/lpgoL2WIjkghpxcqc/TVBQ/8uHSyFOvrmXfjqkok9vhPjiBxVcq/dCnN4pc11Zf7sRr+7bTzfdeq/vVJnPP12Kk7fth4turc1m1hmoLE8GS5Yi6o9QQlCj/6zdbhtB/TdyxW4VWcLLzddnD0u9uCv2OigujVrNJoNdQY8XW7qCGUOQoRcko+Ch/agqCn2IdYXQ3q7UH/z8YbUw3s7u2/+6VF8+yJWulKArmVa87ddXDDNotoR0S2IOsCKCun0+/btfqgX1NdFCB5X83InQgkzhPv91KTPovu9M6J/K2DCb1hyXG0FaaAwFBOlvdI2jimSOQlk083mrrKufTQYy+tr+50bQMIMtQXJTB5qGEErUQU83ukr5o/egy6uOrnfm81CQLObpr5+vrYKGGWwJWojdflcwZfpBT79cmirVI4K0iWe7IFsENXENmKJYR3H106bGsddBqqwqMNaV9AFBljpoKeIaMEUBQd1+f6eOM9XwyCLYWzETQWcPT7f2OuhwK7ZV+x1NiQh6v+7WqPMCVz9oXQc5K+lhP2gOgtqPsgZ6fd/23eb7viP8o07QffX1/V4rdvp7031lEzTIYGqCjmQR3fwkojpBC3WtoouOyP5LKqoT1J93JWh/0lCdoPbpzUV/rl8F9QmqDAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB0ghaDwaMzM6kj80nIYn3hILyZkdBKLnQbijIlpyCQHLRriv76Bo/DRUKanUYiTq6ILUKEoKCDiXvxRhRFRC2E+b5EOtjaukOsUkKaszjNUvbk7JRZdLhM2FBq9vN81mWZ3HiBE09gp6v10+gLy0H2fFlWofPhAVljaC1lQkL6uqgPoQy1EHVCzLPnjsxU2dYnwacsSD9YGzcNA4zF9QmcDR3QVqRfbaCjB3FSQiSz4u+6yzYqpicHcX6BckKWJuxdXJedjP/fA2fM7Z3FBNctK9ekAcFIqj8VbPB9hddoa2Vi2LsjqKo4KrZZvsLFRTP167u4sgdxaoEmQrGVkMHZndEysoFmQqmqU1QYUObzesK5vHCXQn189LZNM5ZkJpy0D2nSKOmepSV1EiCRFWCIPooVB3tFxlBEFOPd+3dqIKKOtpsG56IbjqKi/OXKGiBmy+jRU/i584ufEcqF/R87XEhyHSlV7epBYkJCIqaNHc3u+CEdkHu87EE49rcO2Y+rG5TzKo2fgTlbuk2WS/j5l3ezS40YaCgddysoyyTpeFdDdSKhWQXnNApaL/w628Hq0fst2PHKskORNBBQSq0KKgeQWoi9EWRCc6HN+aDBOUfTjSopE/uGjkj/zGGYq9Ji7AI8pSYhK3rQY3jNDQwu9Bk9QuSHUUpqMgVRSxoKziLRtAiaprifILa0oL6Oqgp8poOL0EmhrZr5nFbsehZio/ZyV0P9hN7s41Cgkpll0xQFkMUhPbOfCh3LjYRQT3uVj7L+KCdbrSXIMvqGdjLdOG4LJRnfFBQBO0NNh9+zKFoL0tHCGUa3REmCKyTnL0sHacamQaS+ws6NNh8bEGu0R3FI8hjneTstWKuM40844NSCkpfC4VlmGV8UNIIKiwoS3YTEbR5a2tMX7G8oNSGdm/7uM/mM3UUJyFodavN2NontSx9RzGw8AUFPX+vL3SM3FHcue6eQFBiRXsR5LiimGMgeYYIyiRIXlFs9Sg7G3kiaDKCdDvmvCKdoaM4JUEepO8ozkxQ+uymJKjAredDV3eqFRRz6/lAdl5rhxe+nKASt54zCUpqKOTWs8fpWsi+WS5/JRCUUlHQrWfr4Nb97Lw2nS2CcgjyuvUMR3rOWZDXrWc00nPWgkbNLqLwhQQNTrRSZAdXzCsonaGtVixhdnDFyQmKHFq2lx1aMbOgZIpKDV7IHkGpDM20kqagkQWlqaHbmQtK0dBTkK24oRft7Q8fzFLQTnY+K76sCNrJzmdFCnKuZhsLTkFmtTEEJelPG0Ephna0tQlKoahIRzFR4cE65qsxSpQ4u3EEmTgdo0Qps0tZeApKsU5cNVRCkGuwfAZBcWUcWxAeC/7SBY1/iFGQxzoZS5Q4OwpyLrVe48gsKELRuIJ8ypglgo4Po7BkkQPJywo6TlFQooiB5ELsHF8jCxLHHmohKWKGAfuXMVsE9f8CCUkQPJBcVEwOQR4RND8C6yA0kHx+JB5IPj8S94PmRxZBZatfRA2C4pbHLY5NHrd6mkwpKG45BVFQ3HIKoqC45RREQXHL5y9oTlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBALkHuKUCEsN6aXTpnf3Am9di0fFVq2HvUMglaOm6+rm47A41lP+VUc0urIWdSj00vu0Xut1nvkUeQmszKtvDxQk35eXAQlh4fYZ0V3ZXUY9M697AZkvIIas5+QrfvD4eJhwFbUo9NP34V/taQLIK6HYFvwDn81lJdBDAJhOuFp85NL1/9cw2rsB1yCJKRjARZBtDo4HCGiHPsjXvTjRxcGfi2yxyCPN6htHTU0UCQLanHpvU0o2GTlGQQpA4TtyBrEOBDzDl2C2xa1226nvMlrSD5Pvqrph9mcmA3Gt2LaayFhJW0PanJ37JpiRYfVlWX6Cg65kkDzTyYDxxtWo9CLX6IKRyCHi8cQeDuKDqTemxaVlGBD3cXENQfBxYLjetUw50Ub1qeyFTQzM8KCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEKByQWbConLzOVUuSON6AXVupiDIa9BLLiYgaHVbckawCQgqeYBNQVDRA2wCgsoeYBMQVPYAq19Q4LM56aldkOu5jFGoXBB6dXJ+Khe06IfOlzvOKhdUHgoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCPA/rsUlU+o6qt8AAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>3.conjecture</p>
<p>当<span class="math inline">\(p_{1}\)</span>在0.5附近的时候，总体呈现双峰分布</p>
<p>4.my thoughts</p>
<p>I’m not familiar with showing different pictures in a single screen and making pictures more beautiful.</p>
</div>
<div id="question3" class="section level2">
<h2>question3</h2>
<p>3.18 Write a function to generate a random sample from a <span class="math inline">\(W_{d}(\Sigma, n)\)</span> (Wishart) distribution for <span class="math inline">\(n&gt;d+1 \geq 1\)</span>, based on Bartlett’s decomposition.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>1.basic ideas</p>
<p>首先生成一个下三角阵，满足<span class="math inline">\(T_{i j} \stackrel{i i d}{\sim} N(0,1), i&gt;j\)</span>，且<span class="math inline">\(T_{i i} \sim \sqrt{\chi^{2}(n-i+1)}, i=1, \ldots, d\)</span>，再从Sigma矩阵中得到Choleski factorization，从而利用Bartlett’s decomposition的方法，我们可以生成一组随机样本服从于<span class="math inline">\(W_{d}(\Sigma, n)\)</span></p>
<p>2.code</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>n&lt;-<span class="dv">10</span>; d&lt;-<span class="dv">5</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>X&lt;-<span class="kw">numeric</span>(d)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</span>
<span id="cb14-4"><a href="#cb14-4"></a>  X[i]&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dt">df=</span>n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb14-5"><a href="#cb14-5"></a>  }</span>
<span id="cb14-6"><a href="#cb14-6"></a>A &lt;-<span class="st"> </span><span class="kw">diag</span>(X)<span class="co">#生成符合题意的对角阵</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>d,<span class="dt">ncol=</span>d)</span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d)<span class="co">#生成下三角元服从正态分布的矩阵</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i<span class="dv">-1</span>){</span>
<span id="cb14-10"><a href="#cb14-10"></a>    B[i,j]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb14-11"><a href="#cb14-11"></a>    }</span>
<span id="cb14-12"><a href="#cb14-12"></a>T &lt;-<span class="st"> </span>A<span class="op">+</span>B<span class="co">#符合题意的下三角阵</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>d,<span class="dt">ncol=</span>d)</span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d)<span class="co">#输入多元正态分布的协方差矩阵</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</span>
<span id="cb14-16"><a href="#cb14-16"></a>    <span class="cf">if</span> (i<span class="op">==</span>j)</span>
<span id="cb14-17"><a href="#cb14-17"></a>   Sigma[i,j]&lt;-<span class="dv">4</span></span>
<span id="cb14-18"><a href="#cb14-18"></a>    <span class="cf">else</span></span>
<span id="cb14-19"><a href="#cb14-19"></a>   Sigma[i,j]&lt;-<span class="fl">0.8</span>}</span>
<span id="cb14-20"><a href="#cb14-20"></a>L&lt;-<span class="kw">chol</span>(Sigma)<span class="co">#求出Sigma矩阵的Choleski factorization</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>W&lt;-<span class="kw">t</span>(L)<span class="op">%*%</span>T<span class="op">%*%</span><span class="kw">t</span>(T)<span class="op">%*%</span>L<span class="co">#利用Bartlett’s decomposition生成符合题意的样本</span></span>
<span id="cb14-22"><a href="#cb14-22"></a>W</span></code></pre></div>
<pre><code>##           [,1]     [,2]      [,3]       [,4]       [,5]
## [1,] 24.748954 17.33226  9.564019 10.0163536 11.0758621
## [2,] 17.332263 47.92320 31.629329 18.4335500 12.1283071
## [3,]  9.564019 31.62933 45.896244 48.5469031 -2.9785179
## [4,] 10.016354 18.43355 48.546903 85.2954928 -0.8656502
## [5,] 11.075862 12.12831 -2.978518 -0.8656502 69.7181824</code></pre>
<p>3.my thoughts</p>
<p>不太会写函数，以及如何简便地输入矩阵，此外，复杂的循环语句不太会书写</p>
<div id="homework-of-20191011" class="section level3">
<h3>Homework of 20191011</h3>
</div>
</div>
<div id="question1-1" class="section level2">
<h2>Question1</h2>
<p>5.1 Compute a Monte Carlo estimate of <span class="math inline">\(\theta=\int_{0}^{\frac{\pi}{3}} \sin t d t\)</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>1.basic ideas</p>
<p>We can apply the Mento Carlo method and use a frequency to approximate the integration, so that we can get an estimation of the integration. We can examine the result with the true value. <span class="math inline">\(\theta=\int_{0}^{\frac{\pi}{3}} \sin t d t=E_{Y}\left(\frac{\pi}{3} \sin Y\right), Y \sim U\left(0, \frac{\pi}{3}\right)\)</span></p>
<p>2.code</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>) <span class="co">#generate random numbers</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)) <span class="op">*</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span> <span class="co">#use sample mean to approximate the integration</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="kw">cos</span>(<span class="dv">0</span>) <span class="op">-</span><span class="st"> </span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>))) <span class="co">#compare the approximation and the true value</span></span></code></pre></div>
<pre><code>## [1] 0.4991499 0.5000000</code></pre>
<p>3.my thoughts</p>
<p>The Monte Carlo method provides a simple and accurate method to appoximate some complicated integrations in a general way.</p>
</div>
<div id="question2-1" class="section level2">
<h2>Question2</h2>
<p>5.10 Use Monte Carlo integration with antithetic variables to estimate <span class="math inline">\(\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x\)</span>, and ﬁnd the approximate reduction in varianceas a percentage of the variance without variance reduction.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>1.basic ideas</p>
<p>We use the standard Mento Carlo method and Monte Carlo method with antithetic variables to approximate the integration, and we compare the two results by their variances.</p>
<p>2.code</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>x1 &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb18-3"><a href="#cb18-3"></a>x2 &lt;-<span class="st"> </span><span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>) <span class="co">#generate m/2 samples to ensure the total are the same with the 1st method</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>MC_standard&lt;-<span class="kw">numeric</span>(m); MC_antithetic&lt;-<span class="kw">numeric</span>(m<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a>MC_standard&lt;-<span class="kw">exp</span>(<span class="op">-</span>x1)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x1<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a>MC_antithetic&lt;-<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>x2)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x2<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">+</span>x2)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>x2)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb18-7"><a href="#cb18-7"></a>theta.stan &lt;-<span class="st"> </span><span class="kw">mean</span>(MC_standard) <span class="co">#the standard Mento Carlo method </span></span>
<span id="cb18-8"><a href="#cb18-8"></a>se.stan&lt;-<span class="st"> </span><span class="kw">sd</span>(MC_standard)</span>
<span id="cb18-9"><a href="#cb18-9"></a>theta.anti &lt;-<span class="st"> </span><span class="kw">mean</span>(MC_antithetic) <span class="co">#the Monte Carlo method with antithetic variables</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>se.anti &lt;-<span class="st"> </span><span class="kw">sd</span>(MC_antithetic)</span>
<span id="cb18-11"><a href="#cb18-11"></a>reduc_sd &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sd</span>(MC_antithetic)<span class="op">/</span><span class="kw">sd</span>(MC_standard) <span class="co">#the reduction of sd</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="kw">cbind</span>(theta.stan,theta.anti,se.stan,se.anti,reduc_sd)</span></code></pre></div>
<pre><code>##      theta.stan theta.anti  se.stan    se.anti  reduc_sd
## [1,]  0.5241942  0.5241468 0.245895 0.03327171 0.8646914</code></pre>
<p>3.my thoughts</p>
<p>This printing result shows that the Mento Carlo method with antithetic variables greatly reduced the sd by more than 86% than the standard Mento Carlo method.</p>
</div>
<div id="question3-1" class="section level2">
<h2>Question3</h2>
<p>5.15 Obtain the stratiﬁed importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>1.basic ideas</p>
<p>We first choose several importance functions to estimate <span class="math inline">\(\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x\)</span>, and we can easily find that the 4th choice is the best. Then we use stratified importance sampling to estimate the integration again and compare the result with the former best one.</p>
<p>Because<span class="math inline">\(\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x=\int_{\alpha_0}^{\alpha_{1}} \frac{1-e^{-1}}{5\left(1+x^{2}\right)} \frac{5 e^{-x}}{1-e^{-1}} d x+\cdots+\int_{\alpha_{4}}^{\alpha_{5}} \frac{1-e^{-1}}{5\left(1+x^{2}\right)} \frac{5 e^{-x}}{1-e^{-1}} d x\)</span>, we first generate random numbers from the distribution with the density function: <span class="math inline">\(f(x)=\frac{5e^{-x}}{1-e^{-1}}\)</span>,<span class="math inline">\(\alpha_{ j}\)</span>&lt;x&lt;<span class="math inline">\(\alpha_{ j+1}\)</span>, where <span class="math inline">\(\alpha_{ j}\)</span> is the <span class="math inline">\(\frac{j}{5} \times 100\%\)</span> of the distribution with a density function: <span class="math inline">\(f(x)=\frac{e^{-x}}{1-e^{-1}}, 0&lt;x&lt;1\)</span>. And then we add the means of each interval to get an estimation of the integration and other results.</p>
<p>2.code</p>
<p>(1)several possible choices of importance functions to estimate<span class="math inline">\(\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x\)</span> by importance sampling method are compared as below.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>) }</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#using f0</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x)</span>
<span id="cb20-8"><a href="#cb20-8"></a>theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb20-9"><a href="#cb20-9"></a>se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb20-10"><a href="#cb20-10"></a></span>
<span id="cb20-11"><a href="#cb20-11"></a>x &lt;-<span class="st"> </span><span class="kw">rexp</span>(m, <span class="dv">1</span>) <span class="co">#using f1</span></span>
<span id="cb20-12"><a href="#cb20-12"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x)</span>
<span id="cb20-13"><a href="#cb20-13"></a>theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb20-14"><a href="#cb20-14"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb20-15"><a href="#cb20-15"></a></span>
<span id="cb20-16"><a href="#cb20-16"></a>x &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(m) <span class="co">#using f2</span></span>
<span id="cb20-17"><a href="#cb20-17"></a>i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">which</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>), <span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>))</span>
<span id="cb20-18"><a href="#cb20-18"></a>x[i] &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">#to catch overflow errors in g(x)</span></span>
<span id="cb20-19"><a href="#cb20-19"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dcauchy</span>(x)</span>
<span id="cb20-20"><a href="#cb20-20"></a>theta.hat[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb20-21"><a href="#cb20-21"></a>se[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb20-22"><a href="#cb20-22"></a></span>
<span id="cb20-23"><a href="#cb20-23"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f3, inverse transform method</span></span>
<span id="cb20-24"><a href="#cb20-24"></a>x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb20-25"><a href="#cb20-25"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb20-26"><a href="#cb20-26"></a>theta.hat[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb20-27"><a href="#cb20-27"></a>se[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb20-28"><a href="#cb20-28"></a></span>
<span id="cb20-29"><a href="#cb20-29"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f4, inverse transform method</span></span>
<span id="cb20-30"><a href="#cb20-30"></a>x &lt;-<span class="st"> </span><span class="kw">tan</span>(pi <span class="op">*</span><span class="st"> </span>u <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb20-31"><a href="#cb20-31"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>pi))</span>
<span id="cb20-32"><a href="#cb20-32"></a>theta.hat[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb20-33"><a href="#cb20-33"></a>se[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb20-34"><a href="#cb20-34"></a></span>
<span id="cb20-35"><a href="#cb20-35"></a><span class="kw">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]      [,3]       [,4]      [,5]
## theta.hat 0.5274585 0.5173368 0.5326603 0.52427878 0.5219397
## se        0.2455041 0.4193503 0.9531396 0.09722148 0.1407995</code></pre>
<p>(2)Stratiﬁed Importance Sampling</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>k &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#number of strata</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>r &lt;-<span class="st"> </span>m<span class="op">/</span>k <span class="co">#replicates per stratum</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#compute the 0%, 20%, 40%, 60%, 80% and 100%percentiles</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>alpha &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">6</span>)</span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>){</span>
<span id="cb22-7"><a href="#cb22-7"></a>  alpha[j] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">*</span>(j<span class="dv">-1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb22-8"><a href="#cb22-8"></a>}</span>
<span id="cb22-9"><a href="#cb22-9"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span><span class="dv">2000</span>,<span class="dt">ncol=</span><span class="dv">5</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x)(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb22-11"><a href="#cb22-11"></a>est &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="co">#the inverse transform method to generate samples </span></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb22-14"><a href="#cb22-14"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(r)</span>
<span id="cb22-15"><a href="#cb22-15"></a>  x[,j] &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">*</span>(u<span class="op">+</span>j<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb22-16"><a href="#cb22-16"></a>  est[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(x[,j]))</span>
<span id="cb22-17"><a href="#cb22-17"></a>  }</span>
<span id="cb22-18"><a href="#cb22-18"></a>theta.hat&lt;-<span class="kw">sum</span>(est); se&lt;-<span class="kw">sd</span>(<span class="kw">g</span>(x))</span>
<span id="cb22-19"><a href="#cb22-19"></a><span class="kw">cbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##      theta.hat         se
## [1,] 0.5247928 0.01937507</code></pre>
<p>3.my thoughts</p>
<p>We can find that the result of Stratiﬁed Importance Sampling is quite better than the former best one of the method of importance functions.</p>
<div id="homework-of-20191018" class="section level3">
<h3>Homework of 20191018</h3>
</div>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>6.5 Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the conﬁdence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p>6.6 Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span>.</p>
</div>
<div id="answer-of-6.5" class="section level2">
<h2>Answer of 6.5</h2>
<p>1.basic ideas</p>
<p>Use a Monte Carlo experiment to estimate the coverage probability of three different confidence intervals and compare them.</p>
<p>2.code</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>covp &lt;-<span class="st"> </span><span class="cf">function</span>(m){</span>
<span id="cb24-3"><a href="#cb24-3"></a>  n &lt;-<span class="st"> </span><span class="dv">20</span>; alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  LCL_mean &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb24-5"><a href="#cb24-5"></a>  UCL_mean &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb24-6"><a href="#cb24-6"></a>  UCL_var_chisq &lt;-<span class="st"> </span>UCL_var_normal &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb24-7"><a href="#cb24-7"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb24-8"><a href="#cb24-8"></a>    x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>) <span class="co">#samples from chisq with mean=2, var=4</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>    <span class="co">#the lower and upper confidence limit of mean</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>    LCL_mean[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb24-11"><a href="#cb24-11"></a>    UCL_mean[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb24-12"><a href="#cb24-12"></a>    <span class="co">#the one-side upper confidence limit of variance</span></span>
<span id="cb24-13"><a href="#cb24-13"></a>    UCL_var_chisq[i] &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb24-14"><a href="#cb24-14"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n) <span class="co">#samples from norm with mean=0, var=1</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>    <span class="co">#the one-side upper confidence limit of variance</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>    UCL_var_normal[i] &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(y)<span class="op">/</span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb24-17"><a href="#cb24-17"></a>  }</span>
<span id="cb24-18"><a href="#cb24-18"></a>  <span class="co">#coverage probability of mean from chisq distribution</span></span>
<span id="cb24-19"><a href="#cb24-19"></a>  covp_mean_chisq &lt;-<span class="st"> </span><span class="kw">mean</span>(LCL_mean<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span><span class="dv">2</span><span class="op">&lt;</span>UCL_mean)</span>
<span id="cb24-20"><a href="#cb24-20"></a>  <span class="co">#coverage probability of variance from chisq distribution</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>  covp_var_chisq &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="dv">4</span><span class="op">&lt;</span>UCL_var_chisq)</span>
<span id="cb24-22"><a href="#cb24-22"></a>  <span class="co">#coverage probability of variance from normal distribution</span></span>
<span id="cb24-23"><a href="#cb24-23"></a>  covp_var_normal &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="dv">1</span><span class="op">&lt;</span>UCL_var_normal)</span>
<span id="cb24-24"><a href="#cb24-24"></a>  <span class="kw">cbind</span>(covp_mean_chisq,covp_var_chisq,covp_var_normal)</span>
<span id="cb24-25"><a href="#cb24-25"></a>}</span>
<span id="cb24-26"><a href="#cb24-26"></a>m&lt;-<span class="fl">1e3</span>; <span class="kw">covp</span>(m)</span></code></pre></div>
<pre><code>##      covp_mean_chisq covp_var_chisq covp_var_normal
## [1,]           0.924          0.782           0.947</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>m&lt;-<span class="fl">1e4</span>; <span class="kw">covp</span>(m)</span></code></pre></div>
<pre><code>##      covp_mean_chisq covp_var_chisq covp_var_normal
## [1,]          0.9218         0.7863          0.9551</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>m&lt;-<span class="fl">1e5</span>; <span class="kw">covp</span>(m)</span></code></pre></div>
<pre><code>##      covp_mean_chisq covp_var_chisq covp_var_normal
## [1,]            0.92        0.78402         0.95107</code></pre>
<p>3.my thoughts</p>
<p>We can find that the 1st and 2nd coverage probabilties are always smaller than the true confidence levels because the samples are not from a normal distribution. However, we choose the t-statistic to construct the confidence interval, hence the method is wrong theorically.</p>
<p>At the same time, we can find the 3rd coverage probability is quite close to the true probability and it will get closer as the number of replicates becomes bigger because the confidence interval is correct theorically.</p>
<p>In addition, the confidence interval of mean performs better than that of variance, and I’m not quite sure of the reasons, maybe the former interval is more robust.</p>
</div>
<div id="answer-of-6.6" class="section level2">
<h2>Answer of 6.6</h2>
<p>1.basic ideas</p>
<p>We first generate samples from normal distribution and replicate the process and use the the mean of sample quantiles to estimate the true quantiles of the skewness. And then we compare the estimated quantiles with the quantiles of the large sample approximation.</p>
<p>Also, we use <span class="math inline">\(\operatorname{Var}\left(\hat{x}_{q}\right)=\frac{q(1-q)}{n f\left(x_{q}\right)^{2}}\)</span> to compute the standard error of the estimates.</p>
<p>2.code</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>n &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#sample sizes</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#replicates to compute a sample quantile once</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>k &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co">#replicates of Mento Carlo experiment</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>alpha &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>) <span class="co">#different probabilities of quantiles</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>skew &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb30-7"><a href="#cb30-7"></a>se_quantile.hat &lt;-<span class="st"> </span>quantile.appro &lt;-<span class="st"> </span>quantile.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb30-8"><a href="#cb30-8"></a>quantile &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span><span class="dv">4</span>)</span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="co">#we compute k sample quantiles of every probability</span></span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb30-11"><a href="#cb30-11"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb30-12"><a href="#cb30-12"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</span>
<span id="cb30-13"><a href="#cb30-13"></a>    skew[j] &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)  <span class="co">#sample skewness</span></span>
<span id="cb30-14"><a href="#cb30-14"></a>    }</span>
<span id="cb30-15"><a href="#cb30-15"></a>  quantile[i,] &lt;-<span class="st"> </span><span class="kw">quantile</span>(skew, <span class="dt">probs=</span>alpha) <span class="co">#a sample quantiles of skewness</span></span>
<span id="cb30-16"><a href="#cb30-16"></a>}</span>
<span id="cb30-17"><a href="#cb30-17"></a><span class="co">#use the mean of sample quantiles to estimate the sample quantiles</span></span>
<span id="cb30-18"><a href="#cb30-18"></a>quantile.hat &lt;-<span class="st"> </span><span class="kw">colMeans</span>(quantile)</span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb30-20"><a href="#cb30-20"></a><span class="co">#quantiles of the large sample approximation</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>  quantile.appro[i] &lt;-<span class="st"> </span><span class="kw">qnorm</span>(alpha[i],<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</span>
<span id="cb30-22"><a href="#cb30-22"></a><span class="co">#the standard error of the estimates</span></span>
<span id="cb30-23"><a href="#cb30-23"></a>  se_quantile.hat[i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>((alpha[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>alpha[i])<span class="op">/</span>(n<span class="op">*</span>(<span class="kw">dnorm</span>(quantile.appro[i],<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))<span class="op">^</span><span class="dv">2</span>))))</span>
<span id="cb30-24"><a href="#cb30-24"></a>}</span>
<span id="cb30-25"><a href="#cb30-25"></a><span class="kw">cbind</span>(alpha,quantile.hat,quantile.appro,se_quantile.hat)   </span></code></pre></div>
<pre><code>##      alpha quantile.hat quantile.appro se_quantile.hat
## [1,] 0.025   -0.6436164     -0.6789514       0.1308670
## [2,] 0.050   -0.5292504     -0.5697940       0.1035246
## [3,] 0.950    0.5319939      0.5697940       0.1035246
## [4,] 0.975    0.6428719      0.6789514       0.1308670</code></pre>
<p>3.my thoughts</p>
<p>We can find the results of Mento Carlo method is close to the results of large sample approximation and the stand error is not big so that the Mento Carlo Method provides a good method to do statistic inference.</p>
<div id="homework-of-20191101" class="section level3">
<h3>Homework of 20191101</h3>
</div>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>6.7 Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
<p>6.A Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal signiﬁcance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^{2}(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test: <span class="math inline">\(H_{0}: \mu=\mu_{0}\)</span> vs <span class="math inline">\(H_{1}: \mu \neq \mu_{0}\)</span>, where<span class="math inline">\(\mu_{0}\)</span> is the mean of <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
<p>Discussion: If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>(1)What is the corresponding hypothesis test problem?</p>
<p>(2)What test should we use? Z-test, two-sample t-test, paired t-test or McNemar test?</p>
<p>(3)What information is needed to test your hypothesis?</p>
</div>
<div id="answer-of-6.7" class="section level2">
<h2>Answer of 6.7</h2>
<p>1.basic ideas</p>
<p>Use Monte Carlo methods to estimate the power of skewness test of normality against symmetric <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span> distributions and heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>.</p>
<p>2.code</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co">#skewness test of normality against symmetric Beta distribution</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>alpha&lt;-<span class="fl">0.05</span>; n&lt;-<span class="dv">100</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>a&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>,<span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="co"># critical value for the skewness test</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>cv&lt;-<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="co"># the function to compute skewness of samples</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb32-8"><a href="#cb32-8"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(a))</span>
<span id="cb32-9"><a href="#cb32-9"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co"># num. repl. each sim.</span></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(a)) {</span>
<span id="cb32-11"><a href="#cb32-11"></a>  sktests&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb32-13"><a href="#cb32-13"></a>    x &lt;-<span class="st">  </span><span class="kw">rbeta</span>(n,a[i],a[i]) <span class="co"># test decision is 1 (reject) or 0</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) </span>
<span id="cb32-15"><a href="#cb32-15"></a>    }</span>
<span id="cb32-16"><a href="#cb32-16"></a>  pwr[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co"># proportion rejected, that is the power of test</span></span>
<span id="cb32-17"><a href="#cb32-17"></a>}</span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="kw">plot</span>(a,pwr,<span class="dt">xlab =</span> <span class="st">&quot;parameter of Beta distribution&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power of test&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.comments</p>
<p>the power of test is poor generally although it will get higher from zero to the nominal level as the parameter of Beta distribution becomes bigger.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># skewness test of normality against heavy-tailed symmetric alternatives such as t distribution</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>alpha&lt;-<span class="fl">0.05</span>; n&lt;-<span class="dv">100</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>a&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">30</span>,<span class="dv">1</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a>cv&lt;-<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb33-5"><a href="#cb33-5"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(a))</span>
<span id="cb33-7"><a href="#cb33-7"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(a)) {</span>
<span id="cb33-9"><a href="#cb33-9"></a>  sktests&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb33-10"><a href="#cb33-10"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb33-11"><a href="#cb33-11"></a>    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,a[i]) <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb33-12"><a href="#cb33-12"></a>    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb33-13"><a href="#cb33-13"></a>    }</span>
<span id="cb33-14"><a href="#cb33-14"></a>  pwr[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>}</span>
<span id="cb33-16"><a href="#cb33-16"></a><span class="kw">plot</span>(a,pwr,<span class="dt">xlab =</span> <span class="st">&quot;df of t distribution&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power of test&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>4.comparison and my thoughts</p>
<p>The powers of test against t distribution get lower from 100% to the nominal level 5% as the df of t distribution becomes bigger. We can find that the tendency of two tests is contrary but they all get closer to the nominal level as the parameters get bigger.</p>
</div>
<div id="answer-of-6.a" class="section level2">
<h2>Answer of 6.A</h2>
<p>1.basic ideas</p>
<p>Use Monte Carlo experiment to assess Type I error rate.</p>
<p>2.code</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co">#H0:mu=1</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span>; n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a>p.valx &lt;-<span class="st"> </span>p.valy &lt;-<span class="st"> </span>p.valz &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb34-6"><a href="#cb34-6"></a>  <span class="co"># generate samples from $\chi^{2}(1)$ and compute p-value</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8"></a>  p.valx[i] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(<span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">sd</span>(x)),n<span class="dv">-1</span>))</span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="co"># generate samples from uniform(0,2) and compute p-value</span></span>
<span id="cb34-10"><a href="#cb34-10"></a>  y&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb34-11"><a href="#cb34-11"></a>  p.valy[i] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(<span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(y)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">sd</span>(y)),n<span class="dv">-1</span>))</span>
<span id="cb34-12"><a href="#cb34-12"></a>  <span class="co"># generate samples from Exp(1) and compute p-value</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>  z&lt;-<span class="kw">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb34-14"><a href="#cb34-14"></a>  p.valz[i] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(<span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(z)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">sd</span>(z)),n<span class="dv">-1</span>))</span>
<span id="cb34-15"><a href="#cb34-15"></a>}</span>
<span id="cb34-16"><a href="#cb34-16"></a><span class="co">#print the t1es</span></span>
<span id="cb34-17"><a href="#cb34-17"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.valx<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.valy<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.valz<span class="op">&lt;=</span><span class="fl">0.05</span>)))</span></code></pre></div>
<pre><code>## [1] 0.0496 0.0521 0.0465</code></pre>
<p>3.my thoughts</p>
<p>We can find that the t1es are quite close to the nominal level of the test, which means that even though the sampled population is non-normal, the t-test is quite robust to mild departures from normality.</p>
</div>
<div id="answer-of-discussion" class="section level2">
<h2>Answer of discussion</h2>
<p>(1)Let’s take the statistic set “sleep” for an example, we may care about whether the new medicine is effective in improving the quality of sleeping, that is whether the means of two sampled population are the same or not in another word. So the null hypothesis is “<span class="math inline">\(\mu_{1}=\mu_{2}\)</span>”, and the alternative hypothsis is “<span class="math inline">\(\mu_{1}\neq\mu_{2}\)</span>”.</p>
<p>(2)We can use two-sample t-test or paired t-test to test the hypothesises.</p>
<p>(3)We need to know whether the distributions and of the sampled populations are normal or not, the variances of two sampled population are the same or not and the two sampled populations are independent or paired. All these above informations will determine which test we shall use.</p>
<div id="homework-of-20191108" class="section level3">
<h3>Homework of 20191108</h3>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>7.6 Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in ﬁve subjects [84, Table7.1], [188, Table1.2.1]. The ﬁrst two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\(\left(x_{i 1}, \ldots, x_{i 5}\right)\)</span> for the ith student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec})\)</span>, <span class="math inline">\(\hat{\rho}_{34}=\hat{\rho}(\mathrm{alg}, \mathrm{ana})\)</span>, <span class="math inline">\(\hat{\rho}_{35}=\hat{\rho}(\mathrm{alg}, \mathrm{sta})\)</span>, <span class="math inline">\(\hat{\rho}_{45}=\hat{\rho}(\mathrm{ana}, \mathrm{sta})\)</span>.</p>
<p>7.B Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^{2}(5)\)</span> distributions (positive skewness).</p>
</div>
<div id="answer-of-7.6" class="section level2">
<h2>Answer of 7.6</h2>
<p>1.basic ideas</p>
<p>bootstrap samples to estimate the standard errors of different correlations</p>
<p>2.code</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb36-4"><a href="#cb36-4"></a>scor&lt;-<span class="kw">as.matrix</span>(scor)</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co"># display the scatter plots for each pair of test scores</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="kw">pairs</span>(scor)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># compute the correlations</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="kw">cor</span>(scor)</span></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># bootstrap estimates of the correlations and their standard errors</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>b.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])</span>
<span id="cb39-3"><a href="#cb39-3"></a>obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>b.cor,<span class="dt">R=</span><span class="dv">10000</span>)</span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">rho12=</span>obj<span class="op">$</span>t0,<span class="dt">se=</span><span class="kw">sd</span>(obj<span class="op">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## rho12    se 
## 0.553 0.076</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>b.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">3</span>],x[i,<span class="dv">4</span>])</span>
<span id="cb41-2"><a href="#cb41-2"></a>obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>b.cor,<span class="dt">R=</span><span class="dv">10000</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">rho34=</span>obj<span class="op">$</span>t0,<span class="dt">se=</span><span class="kw">sd</span>(obj<span class="op">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## rho34    se 
## 0.711 0.048</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>b.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">3</span>],x[i,<span class="dv">5</span>])</span>
<span id="cb43-2"><a href="#cb43-2"></a>obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>b.cor,<span class="dt">R=</span><span class="dv">10000</span>)</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">rho35=</span>obj<span class="op">$</span>t0,<span class="dt">se=</span><span class="kw">sd</span>(obj<span class="op">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## rho35    se 
## 0.665 0.060</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>b.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">4</span>],x[i,<span class="dv">5</span>])</span>
<span id="cb45-2"><a href="#cb45-2"></a>obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>b.cor,<span class="dt">R=</span><span class="dv">10000</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">rho45=</span>obj<span class="op">$</span>t0,<span class="dt">se=</span><span class="kw">sd</span>(obj<span class="op">$</span>t)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## rho45    se 
## 0.607 0.068</code></pre>
<p>3.my thoughts</p>
<p>We can find that both these relationships are positive. Further, the relationship between the two tests of closed book is lower than those tests of open book.</p>
</div>
<div id="answer-of-7b" class="section level2">
<h2>Answer of 7B</h2>
<p>1.basic ideas</p>
<p>We can use bootstrap and Mento Carlo methods to calculate the coverage rates and missing proportions for the sample skewness statistic from different populations.</p>
<p>2.code</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="co"># the package to compute sample skewness and bootstrap</span></span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="kw">library</span>(moments); <span class="kw">library</span>(boot)</span>
<span id="cb47-4"><a href="#cb47-4"></a>n&lt;-<span class="fl">1e2</span>; m&lt;-<span class="fl">1e3</span></span>
<span id="cb47-5"><a href="#cb47-5"></a>boot.skew &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">skewness</span>(x[i])</span>
<span id="cb47-6"><a href="#cb47-6"></a>ci_norm&lt;-ci_chisq&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb47-7"><a href="#cb47-7"></a></span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="co"># mento carlo methods to compute coverage probability</span></span>
<span id="cb47-9"><a href="#cb47-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb47-10"><a href="#cb47-10"></a>  <span class="co"># generate original sample</span></span>
<span id="cb47-11"><a href="#cb47-11"></a>  U&lt;-<span class="kw">rnorm</span>(n)</span>
<span id="cb47-12"><a href="#cb47-12"></a>  V&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb47-13"><a href="#cb47-13"></a>  <span class="co"># bootstrap to compute skewness</span></span>
<span id="cb47-14"><a href="#cb47-14"></a>  out1 &lt;-<span class="st"> </span><span class="kw">boot</span>(U,<span class="dt">statistic=</span>boot.skew, <span class="dt">R =</span> <span class="dv">999</span>)</span>
<span id="cb47-15"><a href="#cb47-15"></a>  out2 &lt;-<span class="st"> </span><span class="kw">boot</span>(V,<span class="dt">statistic=</span>boot.skew, <span class="dt">R =</span> <span class="dv">999</span>)</span>
<span id="cb47-16"><a href="#cb47-16"></a>  <span class="co"># compute the confidence interval</span></span>
<span id="cb47-17"><a href="#cb47-17"></a>  ci_norm[i,] &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(out1,<span class="dt">type=</span><span class="st">&quot;norm&quot;</span>)<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb47-18"><a href="#cb47-18"></a>  ci_chisq[i,] &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(out2,<span class="dt">type=</span><span class="st">&quot;norm&quot;</span>)<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb47-19"><a href="#cb47-19"></a>}</span>
<span id="cb47-20"><a href="#cb47-20"></a><span class="co"># print the results</span></span>
<span id="cb47-21"><a href="#cb47-21"></a><span class="kw">cbind</span>(<span class="dt">cp_norm =</span><span class="kw">mean</span>(ci_norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span><span class="op">&amp;</span>ci_norm[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>),<span class="dt">prop_left=</span><span class="kw">mean</span>(<span class="dv">0</span><span class="op">&lt;</span>ci_norm[,<span class="dv">1</span>]),<span class="dt">prop_right=</span><span class="kw">mean</span>(<span class="dv">0</span><span class="op">&gt;</span>ci_norm[,<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>##      cp_norm prop_left prop_right
## [1,]   0.913     0.042      0.045</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">cbind</span>(<span class="dt">cp_chisq =</span><span class="kw">mean</span>(ci_chisq[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)<span class="op">&amp;</span>ci_chisq[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)),<span class="dt">prop_left=</span><span class="kw">mean</span>(<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)<span class="op">&lt;</span>ci_chisq[,<span class="dv">1</span>]),<span class="dt">prop_right=</span><span class="kw">mean</span>(<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)<span class="op">&gt;</span>ci_chisq[,<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>##      cp_chisq prop_left prop_right
## [1,]    0.793      0.03      0.177</code></pre>
<p>3.thoughts</p>
<p>We can find that the coverage rate of normal distribution is bigger than that of chisq distribution, which means the CI of skewness for normal distribution is better than that of the chisq distribution.</p>
<p>What’s more, the proportion of times missing on the left and right is almost the same for the normal distribution, which means that normal distribution is symmetric.</p>
<p>However, the chisq the proportion of times missing on the right is apparently more than the proportion on the left, which means that chisq distribution is asymmetric, in fact, it inclines towards right.</p>
<div id="homework-of-20191115" class="section level3">
<h3>Homework of 20191115</h3>
</div>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>7.8 Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p>7.10 In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best ﬁtting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
</div>
<div id="answer-of-7.8" class="section level2">
<h2>Answer of 7.8</h2>
<p>1.basic ideas</p>
<p>Use the formats of jackknife to estimate bias and stanard error</p>
<p>2.code</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb51-2"><a href="#cb51-2"></a>lambda.hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb51-3"><a href="#cb51-3"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">max</span>(lambda.hat)<span class="op">/</span><span class="kw">sum</span>(lambda.hat)</span>
<span id="cb51-4"><a href="#cb51-4"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb51-5"><a href="#cb51-5"></a>theta.j &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="co">#leave one out</span></span>
<span id="cb51-7"><a href="#cb51-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb51-8"><a href="#cb51-8"></a>  x &lt;-<span class="st"> </span>scor [<span class="op">-</span>i,]</span>
<span id="cb51-9"><a href="#cb51-9"></a>  lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb51-10"><a href="#cb51-10"></a>  theta.j[i] &lt;-<span class="st"> </span><span class="kw">max</span>(lambda)<span class="op">/</span><span class="kw">sum</span>(lambda)</span>
<span id="cb51-11"><a href="#cb51-11"></a>}</span>
<span id="cb51-12"><a href="#cb51-12"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.j)<span class="op">-</span>theta.hat)</span>
<span id="cb51-13"><a href="#cb51-13"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n<span class="op">*</span><span class="kw">var</span>(theta.j))</span>
<span id="cb51-14"><a href="#cb51-14"></a><span class="co">#print bias and se</span></span>
<span id="cb51-15"><a href="#cb51-15"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias.jack=</span>bias.jack, <span class="dt">se.jack=</span>se.jack),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## bias.jack   se.jack 
##   0.00107   0.04955</code></pre>
<p>3.my thoughts</p>
<p>We can find that the bias is quite close to zero and the standard error is very small.</p>
</div>
<div id="answer-of-7.10" class="section level2">
<h2>Answer of 7.10</h2>
<p>1.basic ideas</p>
<p>Cross validation and adjusted R square are applied to select the best regression model</p>
<p>2.code</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb57-2"><a href="#cb57-2"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)</span>
<span id="cb57-3"><a href="#cb57-3"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="co">#for n-fold cross validation</span></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb57-6"><a href="#cb57-6"></a>  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>i]</span>
<span id="cb57-7"><a href="#cb57-7"></a>  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>i]</span>
<span id="cb57-8"><a href="#cb57-8"></a><span class="co">#Fit the model(s) using only the n−1 observations in the training set</span></span>
<span id="cb57-9"><a href="#cb57-9"></a><span class="co">#Compute the predicted response for the test point</span></span>
<span id="cb57-10"><a href="#cb57-10"></a><span class="co">#Compute the prediction error</span></span>
<span id="cb57-11"><a href="#cb57-11"></a>  </span>
<span id="cb57-12"><a href="#cb57-12"></a>  M1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) <span class="co">#linear model</span></span>
<span id="cb57-13"><a href="#cb57-13"></a>  yhat1 &lt;-<span class="st"> </span>M1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>M1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[i]</span>
<span id="cb57-14"><a href="#cb57-14"></a>  e1[i] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb57-15"><a href="#cb57-15"></a>  </span>
<span id="cb57-16"><a href="#cb57-16"></a>  M2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) <span class="co">#quadratic polynomial model</span></span>
<span id="cb57-17"><a href="#cb57-17"></a>  yhat2 &lt;-<span class="st"> </span>M2<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>M2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[i]<span class="op">+</span>M2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[i]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb57-18"><a href="#cb57-18"></a>  e2[i] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb57-19"><a href="#cb57-19"></a>  </span>
<span id="cb57-20"><a href="#cb57-20"></a>  M3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) <span class="co">#exponential model</span></span>
<span id="cb57-21"><a href="#cb57-21"></a>  logyhat3 &lt;-<span class="st"> </span>M3<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>M3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[i]</span>
<span id="cb57-22"><a href="#cb57-22"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb57-23"><a href="#cb57-23"></a>  e3[i] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat3</span>
<span id="cb57-24"><a href="#cb57-24"></a></span>
<span id="cb57-25"><a href="#cb57-25"></a>  M4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>)) <span class="co">#cubic polynomial model</span></span>
<span id="cb57-26"><a href="#cb57-26"></a>  yhat4 &lt;-<span class="st"> </span>M4<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>M4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[i]<span class="op">+</span>M4<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[i]<span class="op">^</span><span class="dv">2</span><span class="op">+</span>M4<span class="op">$</span>coef[<span class="dv">4</span>]<span class="op">*</span>chemical[i]<span class="op">^</span><span class="dv">3</span></span>
<span id="cb57-27"><a href="#cb57-27"></a>  e4[i] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb57-28"><a href="#cb57-28"></a>}</span>
<span id="cb57-29"><a href="#cb57-29"></a><span class="co">#calculate the average squared prediction error</span></span>
<span id="cb57-30"><a href="#cb57-30"></a> <span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co">#print the adjusted R squares</span></span>
<span id="cb59-2"><a href="#cb59-2"></a> <span class="kw">c</span>(<span class="kw">summary</span>(M1)<span class="op">$</span>adj.r.squared, <span class="kw">summary</span>(M2)<span class="op">$</span>adj.r.squared, <span class="kw">summary</span>(M3)<span class="op">$</span>adj.r.squared, <span class="kw">summary</span>(M4)<span class="op">$</span>adj.r.squared)</span></code></pre></div>
<pre><code>## [1] 0.5319104 0.5909726 0.5283260 0.5937184</code></pre>
<p>3.my thoughts</p>
<p>According to the cross validation procedure, we should choose the quadratic polynomial model. However, according to maximum adjusted R square, we should choose the cubic polynomial model.</p>
<div id="homework-of-20191122" class="section level3">
<h3>Homework of 20191122</h3>
</div>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>8.3 The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<p>Ex: Power comparison (distance correlation test versus ball covariance test)</p>
<p>Model 1: <span class="math inline">\(Y=X/4+e\)</span>; Model 2: <span class="math inline">\(Y=X/4\times e\)</span></p>
<p>where <span class="math inline">\(X\sim N\left(0_{2},I_{2}\right)\)</span>, <span class="math inline">\(e\sim N\left(0_{2},I_{2}\right)\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(e\)</span> are independent.</p>
</div>
<div id="answer-of-8.3" class="section level2">
<h2>Answer of 8.3</h2>
<p>1.basic ideas</p>
<p>In order to overcome the problem we met in eg 6.15, we can use permutation to generate samples with equal sizes and then compute the Count Five statistic.</p>
<p>2.code</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="co">## count5 function</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb61-4"><a href="#cb61-4"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb61-5"><a href="#cb61-5"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb61-6"><a href="#cb61-6"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb61-7"><a href="#cb61-7"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X)) </span>
<span id="cb61-8"><a href="#cb61-8"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb61-10"><a href="#cb61-10"></a>}</span>
<span id="cb61-11"><a href="#cb61-11"></a><span class="co">## generate samples with unequal sizes and same variance</span></span>
<span id="cb61-12"><a href="#cb61-12"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span>; n2 &lt;-<span class="st"> </span><span class="dv">30</span>; N &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb61-13"><a href="#cb61-13"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span>; sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span> </span>
<span id="cb61-14"><a href="#cb61-14"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1); y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb61-15"><a href="#cb61-15"></a></span>
<span id="cb61-16"><a href="#cb61-16"></a><span class="co">#use permutation to estimate t1e with sample size of 20 and 30</span></span>
<span id="cb61-17"><a href="#cb61-17"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y); R &lt;-<span class="st"> </span><span class="dv">9999</span>; t &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb61-18"><a href="#cb61-18"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</span>
<span id="cb61-19"><a href="#cb61-19"></a>  k &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>N, <span class="dt">size =</span> N<span class="op">/</span><span class="dv">2</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb61-20"><a href="#cb61-20"></a>  x1 &lt;-<span class="st"> </span>z[k]; y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co"># a new group of X and Y with the same size</span></span>
<span id="cb61-21"><a href="#cb61-21"></a>  t[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1,y1)</span>
<span id="cb61-22"><a href="#cb61-22"></a>}</span>
<span id="cb61-23"><a href="#cb61-23"></a>p1 &lt;-<span class="st"> </span><span class="kw">mean</span>(t)<span class="co"># t1e</span></span>
<span id="cb61-24"><a href="#cb61-24"></a></span>
<span id="cb61-25"><a href="#cb61-25"></a><span class="co">#generate another group of samples with sample size of 20 and 50</span></span>
<span id="cb61-26"><a href="#cb61-26"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span>; n2 &lt;-<span class="st"> </span><span class="dv">50</span>; N &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb61-27"><a href="#cb61-27"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span>; sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb61-28"><a href="#cb61-28"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1); y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb61-29"><a href="#cb61-29"></a></span>
<span id="cb61-30"><a href="#cb61-30"></a><span class="co">#use permutation to estimate t1e </span></span>
<span id="cb61-31"><a href="#cb61-31"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y); R &lt;-<span class="st"> </span><span class="dv">9999</span>; t &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb61-32"><a href="#cb61-32"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</span>
<span id="cb61-33"><a href="#cb61-33"></a>  k &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>N, <span class="dt">size =</span> N<span class="op">/</span><span class="dv">2</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb61-34"><a href="#cb61-34"></a>  x1 &lt;-<span class="st"> </span>z[k]; y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co"># a new group of X and Y with the same size</span></span>
<span id="cb61-35"><a href="#cb61-35"></a>  t[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1,y1)</span>
<span id="cb61-36"><a href="#cb61-36"></a>}</span>
<span id="cb61-37"><a href="#cb61-37"></a>p2 &lt;-<span class="st"> </span><span class="kw">mean</span>(t)<span class="co"># t1e</span></span>
<span id="cb61-38"><a href="#cb61-38"></a></span>
<span id="cb61-39"><a href="#cb61-39"></a><span class="co"># use Mento carlo method to estimate the empirical t1e with sample size of 20 and 50</span></span>
<span id="cb61-40"><a href="#cb61-40"></a>p &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb61-41"><a href="#cb61-41"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</span>
<span id="cb61-42"><a href="#cb61-42"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1); y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb61-43"><a href="#cb61-43"></a>  </span>
<span id="cb61-44"><a href="#cb61-44"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y); R &lt;-<span class="st"> </span><span class="dv">9999</span>; t &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb61-45"><a href="#cb61-45"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</span>
<span id="cb61-46"><a href="#cb61-46"></a>    k &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>N, <span class="dt">size =</span> N<span class="op">/</span><span class="dv">2</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb61-47"><a href="#cb61-47"></a>    x1 &lt;-<span class="st"> </span>z[k]; y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k]</span>
<span id="cb61-48"><a href="#cb61-48"></a>    t[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1,y1)</span>
<span id="cb61-49"><a href="#cb61-49"></a>  }</span>
<span id="cb61-50"><a href="#cb61-50"></a>  p[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(t)</span>
<span id="cb61-51"><a href="#cb61-51"></a>}</span>
<span id="cb61-52"><a href="#cb61-52"></a>p3 &lt;-<span class="st"> </span><span class="kw">mean</span>(p)<span class="co"># empirical t1e</span></span>
<span id="cb61-53"><a href="#cb61-53"></a></span>
<span id="cb61-54"><a href="#cb61-54"></a><span class="co"># print the result</span></span>
<span id="cb61-55"><a href="#cb61-55"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">p1=</span>p1,<span class="dt">p2=</span>p2,<span class="dt">p3=</span>p3),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    p1    p2    p3 
## 0.051 0.065 0.072</code></pre>
<p>3.my thoughts</p>
<p>We can find that the result is quite good. When sample sizes are 20 and 30, we improve the original value in eg 6.15 from 0.1064 to 0.051, and when sample sizes are 20 and 50, we improve it from 0.2934 to 0.065.</p>
<p>I use Mento Carlo method to repeat the simulation above with n1 = 20 and n2 = 50, and I get the empirical t1e (0.072), which is quite good compared with the original t1e in eg 6.15.</p>
<p>As a result, the method with permutation is applicable for unequal sample sizes.</p>
</div>
<div id="answer-of-ex" class="section level2">
<h2>Answer of Ex</h2>
<p>1.basic ideas</p>
<p>Use distance correlation test and ball covariance test to do independence hypothesis test of two different models, and use Mento Carlo method to estimate the powers and compare them with each other.</p>
<p>2.code</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="kw">library</span>(mvtnorm); <span class="kw">library</span>(Ball); <span class="kw">library</span>(boot)</span>
<span id="cb63-3"><a href="#cb63-3"></a>seed &lt;-<span class="st"> </span><span class="dv">12345</span>; m &lt;-<span class="st"> </span><span class="fl">1e2</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>mean &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>); sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow =</span><span class="dv">2</span>)</span>
<span id="cb63-5"><a href="#cb63-5"></a><span class="co">## the statistic of distance correlation test</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>DCOR &lt;-<span class="st"> </span><span class="cf">function</span>(z,ix,dims) {</span>
<span id="cb63-7"><a href="#cb63-7"></a>  p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</span>
<span id="cb63-8"><a href="#cb63-8"></a>  q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</span>
<span id="cb63-9"><a href="#cb63-9"></a>  d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</span>
<span id="cb63-10"><a href="#cb63-10"></a>  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(z[ , <span class="dv">1</span><span class="op">:</span>p])</span>
<span id="cb63-11"><a href="#cb63-11"></a>  y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)])</span>
<span id="cb63-12"><a href="#cb63-12"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb63-13"><a href="#cb63-13"></a>  m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</span>
<span id="cb63-14"><a href="#cb63-14"></a>  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</span>
<span id="cb63-15"><a href="#cb63-15"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</span>
<span id="cb63-16"><a href="#cb63-16"></a>    <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</span>
<span id="cb63-17"><a href="#cb63-17"></a>  Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb63-18"><a href="#cb63-18"></a>    d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</span>
<span id="cb63-19"><a href="#cb63-19"></a>    m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d); M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</span>
<span id="cb63-20"><a href="#cb63-20"></a>    a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</span>
<span id="cb63-21"><a href="#cb63-21"></a>    b <span class="op">+</span><span class="st"> </span>M</span>
<span id="cb63-22"><a href="#cb63-22"></a>  }</span>
<span id="cb63-23"><a href="#cb63-23"></a>  A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x)</span>
<span id="cb63-24"><a href="#cb63-24"></a>  B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</span>
<span id="cb63-25"><a href="#cb63-25"></a>  dCov &lt;-<span class="st"> </span><span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B)</span>
<span id="cb63-26"><a href="#cb63-26"></a>  dVarX &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>A))</span>
<span id="cb63-27"><a href="#cb63-27"></a>  dVarY &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(B <span class="op">*</span><span class="st"> </span>B))</span>
<span id="cb63-28"><a href="#cb63-28"></a>  dCor &lt;-<span class="st"> </span>dCov <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(dVarX <span class="op">*</span><span class="st"> </span>dVarY)</span>
<span id="cb63-29"><a href="#cb63-29"></a>  <span class="kw">return</span>(dCor)</span>
<span id="cb63-30"><a href="#cb63-30"></a>}</span>
<span id="cb63-31"><a href="#cb63-31"></a></span>
<span id="cb63-32"><a href="#cb63-32"></a>N &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">150</span>, <span class="dt">by=</span><span class="dv">10</span>)<span class="co"># different sample sizes</span></span>
<span id="cb63-33"><a href="#cb63-33"></a>power11 &lt;-<span class="st"> </span>power12 &lt;-<span class="st"> </span>power21 &lt;-<span class="st"> </span>power22 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(N))</span>
<span id="cb63-34"><a href="#cb63-34"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb63-35"><a href="#cb63-35"></a></span>
<span id="cb63-36"><a href="#cb63-36"></a><span class="co">## model 1</span></span>
<span id="cb63-37"><a href="#cb63-37"></a><span class="co">## Mento Carlo Method</span></span>
<span id="cb63-38"><a href="#cb63-38"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(N)){</span>
<span id="cb63-39"><a href="#cb63-39"></a>  X1 &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(N[i],mean,sigma); e1 &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(N[i],mean,sigma)</span>
<span id="cb63-40"><a href="#cb63-40"></a>  Y1 &lt;-<span class="st"> </span>X1<span class="op">/</span><span class="dv">4</span><span class="op">+</span>e1 <span class="co">#generate samples</span></span>
<span id="cb63-41"><a href="#cb63-41"></a>  z &lt;-<span class="st"> </span><span class="kw">cbind</span>(X1,Y1); z1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(z)</span>
<span id="cb63-42"><a href="#cb63-42"></a>  </span>
<span id="cb63-43"><a href="#cb63-43"></a>  p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb63-44"><a href="#cb63-44"></a>  </span>
<span id="cb63-45"><a href="#cb63-45"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-46"><a href="#cb63-46"></a>    boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z1, <span class="dt">statistic =</span> DCOR, <span class="dt">R =</span> <span class="dv">99</span>, <span class="dt">sim =</span><span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))<span class="co"># distance correlation test with permutation</span></span>
<span id="cb63-47"><a href="#cb63-47"></a>    tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</span>
<span id="cb63-48"><a href="#cb63-48"></a>    p.values[j,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>tb[<span class="dv">1</span>])</span>
<span id="cb63-49"><a href="#cb63-49"></a>    </span>
<span id="cb63-50"><a href="#cb63-50"></a>    p.values[j,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(X1,Y1,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>j<span class="op">*</span>seed)<span class="op">$</span>p.value<span class="co"># ball covariance test</span></span>
<span id="cb63-51"><a href="#cb63-51"></a>    }</span>
<span id="cb63-52"><a href="#cb63-52"></a>  power11[i] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values <span class="op">&lt;</span><span class="st"> </span>alpha)[<span class="dv">1</span>]</span>
<span id="cb63-53"><a href="#cb63-53"></a>  power12[i] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values <span class="op">&lt;</span><span class="st"> </span>alpha)[<span class="dv">2</span>]</span>
<span id="cb63-54"><a href="#cb63-54"></a>}</span>
<span id="cb63-55"><a href="#cb63-55"></a><span class="co">## draw the graph about powers of two testing methods with model 1</span></span>
<span id="cb63-56"><a href="#cb63-56"></a>par &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)</span>
<span id="cb63-57"><a href="#cb63-57"></a><span class="kw">plot</span>(N,power11,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Model 1&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb63-58"><a href="#cb63-58"></a><span class="kw">lines</span>(N,power12,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb63-59"><a href="#cb63-59"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;dcor&quot;</span>, <span class="st">&quot;ball&quot;</span>), <span class="dt">col =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co">## model 2 (the same process with model 1)</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(N)){</span>
<span id="cb64-3"><a href="#cb64-3"></a>  X2 &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(N[i],mean,sigma); e2 &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(N[i],mean,sigma)</span>
<span id="cb64-4"><a href="#cb64-4"></a>  Y2 &lt;-<span class="st"> </span>(X2<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>e2</span>
<span id="cb64-5"><a href="#cb64-5"></a>  z &lt;-<span class="st"> </span><span class="kw">cbind</span>(X2,Y2); z2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(z)</span>
<span id="cb64-6"><a href="#cb64-6"></a>  </span>
<span id="cb64-7"><a href="#cb64-7"></a>  p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb64-8"><a href="#cb64-8"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb64-9"><a href="#cb64-9"></a>    boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z2, <span class="dt">statistic =</span> DCOR, <span class="dt">R =</span> <span class="dv">99</span>, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb64-10"><a href="#cb64-10"></a>    tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</span>
<span id="cb64-11"><a href="#cb64-11"></a>    p.values[j,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</span>
<span id="cb64-12"><a href="#cb64-12"></a>    </span>
<span id="cb64-13"><a href="#cb64-13"></a>    p.values[j,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(X2,Y2,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>j<span class="op">*</span>seed)<span class="op">$</span>p.value</span>
<span id="cb64-14"><a href="#cb64-14"></a>    }</span>
<span id="cb64-15"><a href="#cb64-15"></a>  power21[i] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values <span class="op">&lt;</span><span class="st"> </span>alpha)[<span class="dv">1</span>]</span>
<span id="cb64-16"><a href="#cb64-16"></a>  power22[i] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values <span class="op">&lt;</span><span class="st"> </span>alpha)[<span class="dv">2</span>]</span>
<span id="cb64-17"><a href="#cb64-17"></a>}</span>
<span id="cb64-18"><a href="#cb64-18"></a></span>
<span id="cb64-19"><a href="#cb64-19"></a><span class="kw">plot</span>(N,power21,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Model 2&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb64-20"><a href="#cb64-20"></a><span class="kw">lines</span>(N,power22,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb64-21"><a href="#cb64-21"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;dcor&quot;</span>, <span class="st">&quot;ball&quot;</span>), <span class="dt">col =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.my thoughts</p>
<p>We can find that, in model 1, the power of distance correlation test is not less than the ball covariance test, which means distance correlation test is more suitable for model 1.</p>
<p>However, in model 2, the power of ball covariance test is not less than the distance correlation test, which means ball covariance test is more suitable for model 2.</p>
<p>All in a word, for different models, we should choose different testing method in order to get the best result.</p>
<div id="homework-of-20191129" class="section level3">
<h3>Homework of 20191129</h3>
</div>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>9.4 Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-of-9.4" class="section level2">
<h2>Answer of 9.4</h2>
<p>1.basic ideas</p>
<p>First we can calculate that, the CDF of Laplace distribution is <span class="math display">\[F(x)=\left\{\begin{array}{ll}{\frac{1}{2} e^{x},} &amp; {x&lt;0} \\ {1-\frac{1} {2}e^{-x}} &amp; {, x \geq 0}\end{array}\right.\]</span> We then implement a random walk Metropolis sampler for generating the standard Laplace distribution and compare them.</p>
<p>2.code</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co">## random walk Metropolis sampler</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb65-4"><a href="#cb65-4"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb65-5"><a href="#cb65-5"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb65-6"><a href="#cb65-6"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb65-7"><a href="#cb65-7"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb65-8"><a href="#cb65-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb65-9"><a href="#cb65-9"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb65-10"><a href="#cb65-10"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y))) <span class="op">/</span><span class="st"> </span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))))</span>
<span id="cb65-11"><a href="#cb65-11"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb65-12"><a href="#cb65-12"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb65-13"><a href="#cb65-13"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb65-14"><a href="#cb65-14"></a>      }</span>
<span id="cb65-15"><a href="#cb65-15"></a>  }</span>
<span id="cb65-16"><a href="#cb65-16"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb65-17"><a href="#cb65-17"></a>}</span>
<span id="cb65-18"><a href="#cb65-18"></a></span>
<span id="cb65-19"><a href="#cb65-19"></a><span class="co">## samples generated by random walk Metropolis sampler with proposal distributions of different variances</span></span>
<span id="cb65-20"><a href="#cb65-20"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span>; sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>); x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb65-21"><a href="#cb65-21"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb65-22"><a href="#cb65-22"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb65-23"><a href="#cb65-23"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb65-24"><a href="#cb65-24"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb65-25"><a href="#cb65-25"></a></span>
<span id="cb65-26"><a href="#cb65-26"></a><span class="co">## plots of four chains</span></span>
<span id="cb65-27"><a href="#cb65-27"></a>index &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2000</span></span>
<span id="cb65-28"><a href="#cb65-28"></a>refline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span><span class="fl">0.025</span>), <span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="fl">-0.975</span>)))</span>
<span id="cb65-29"><a href="#cb65-29"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb65-30"><a href="#cb65-30"></a>  y &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[i], x0, N)<span class="op">$</span>x</span>
<span id="cb65-31"><a href="#cb65-31"></a>  <span class="kw">plot</span>(index,y,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb65-32"><a href="#cb65-32"></a>  <span class="kw">abline</span>(<span class="dt">h=</span>refline,<span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb65-33"><a href="#cb65-33"></a>  <span class="kw">title</span>(<span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[i]))</span>
<span id="cb65-34"><a href="#cb65-34"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co">## compare the quantiles</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>alpha &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="dt">by=</span><span class="fl">0.05</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a>Q &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>alpha[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]), <span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>alpha[<span class="dv">11</span><span class="op">:</span><span class="dv">19</span>])))<span class="co"># the true quantiles of Lapalace disribution</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</span>
<span id="cb66-5"><a href="#cb66-5"></a>mc &lt;-<span class="st"> </span>rw[<span class="dv">401</span><span class="op">:</span>N, ]</span>
<span id="cb66-6"><a href="#cb66-6"></a>Qrw &lt;-<span class="st"> </span><span class="kw">apply</span>(mc,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw">quantile</span>(x, alpha))<span class="co"># the sample quantiles of the four chains</span></span>
<span id="cb66-7"><a href="#cb66-7"></a>qq &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q, Qrw), <span class="dv">3</span>))</span>
<span id="cb66-8"><a href="#cb66-8"></a><span class="kw">names</span>(qq) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;True&#39;</span>,<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>,<span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb66-9"><a href="#cb66-9"></a><span class="kw">print</span>(qq)</span></code></pre></div>
<pre><code>##       True sigma=0.05 sigma=0.5 sigma=2 sigma=16
## 5%  -2.303     20.361    -2.621  -2.402   -2.230
## 10% -1.609     20.449    -1.851  -1.636   -1.424
## 15% -1.204     20.518    -1.258  -1.216   -1.043
## 20% -0.916     20.565    -0.923  -0.925   -0.888
## 25% -0.693     20.616    -0.672  -0.714   -0.758
## 30% -0.511     20.685    -0.463  -0.543   -0.653
## 35% -0.357     20.749    -0.314  -0.385   -0.592
## 40% -0.223     20.842    -0.181  -0.268   -0.468
## 45% -0.105     20.985    -0.105  -0.158   -0.379
## 50%  0.000     21.578     0.003  -0.014   -0.304
## 55%  0.105     21.749     0.103   0.110   -0.101
## 60%  0.223     21.915     0.234   0.274    0.066
## 65%  0.357     22.096     0.370   0.390    0.355
## 70%  0.511     22.199     0.505   0.529    0.490
## 75%  0.693     22.300     0.740   0.652    0.606
## 80%  0.916     22.447     0.991   0.816    0.806
## 85%  1.204     22.796     1.293   1.041    0.871
## 90%  1.609     22.976     1.742   1.363    1.210
## 95%  2.303     23.133     2.577   1.939    1.972</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co">## acceptance rates</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="dt">acceptRate1=</span><span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N, <span class="dt">acceptRate2=</span><span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N, <span class="dt">acceptRate3=</span><span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N, <span class="dt">acceptRate4=</span><span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N))</span></code></pre></div>
<pre><code>## acceptRate1 acceptRate2 acceptRate3 acceptRate4 
##      0.9825      0.8300      0.5210      0.1085</code></pre>
<p>3.my thoughts</p>
<p>In the first plot, the increments are small and the chain is almost like a true random walk although its acceptance is very high.</p>
<p>The second and third chain converge to the target distribution after a short burn-in period of less than 400 and their quantiles are close to the true distribution. Besides, they have an acceptance rate higher than 0.5.</p>
<p>The fourth chain converges and its quantiles are close to the true distribution, but it is inefficient because the acceptance rate is just 0.1085.</p>
<div id="homework-of-20191206" class="section level3">
<h3>Homework of 20191206</h3>
</div>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>11.1 The natural logarithm and exponential functions are inverses of each other, so that mathematically <span class="math inline">\(log(e^x) = e^{log(x)}=x\)</span>. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
<p>11.5 Write a function to solve the equation <span class="math display">\[\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)}\int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \]</span> <span class="math display">\[= \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)}\int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<p>Ex. A-B-O blood type problem</p>
<p>Let the three alleles be A, B, and O with allele frequencies p, q, and r. The 6 genotype frequencies under HWE and complete counts are as follows. <span class="math display">\[\begin{array}{|c|c|c|c|c|c|}\hline \text { Genotype } &amp; {A A} &amp; {B B} &amp; {O O} &amp; {A O} &amp; {B O} &amp; {A B} &amp; {S u m} \\ \hline \text { Frequency } &amp; {p^{2}} &amp; {q^{2}} &amp; {r^{2}} &amp; {2 p r} &amp; {2 q r} &amp; {2 p q} &amp; {1} \\ \hline \text { Count } &amp; {n _{A A}} &amp; {n _{B B}} &amp; {n _{O O}} &amp; {n_ {A O}} &amp; {n _{B O}} &amp; {n_{ A B}} &amp; {n} \\ \hline\end{array}\]</span> Observed data: nA· =nAA +nAO =28 (A-type), nB· =nBB +nBO =24 (B-type), nOO =41 (O-type), nAB =70 (AB-type).</p>
<p>Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB). Show that the log-maximum likelihood values in M-steps are increasing via line plot.</p>
</div>
<div id="answer-of-11.1" class="section level2">
<h2>Answer of 11.1</h2>
<p>1.basic ideas</p>
<p>Mathematical calculation is not computational calculation for base 2 representation is used in computer arithmetic. We use “isTRUE” to compare two numbers to see whether they are equal exactly and use “all.equal” to see whether they are equal nearly.</p>
<p>2.code</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">isTRUE</span>(<span class="kw">exp</span>(<span class="kw">log</span>(<span class="fl">0.1</span>))<span class="op">==</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="fl">0.1</span>))); <span class="kw">isTRUE</span>(<span class="kw">exp</span>(<span class="kw">log</span>(<span class="fl">0.1</span>))<span class="op">==</span><span class="fl">0.1</span>); <span class="kw">isTRUE</span>(<span class="kw">log</span>(<span class="kw">exp</span>(<span class="fl">0.1</span>))<span class="op">==</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">exp</span>(<span class="kw">log</span>(<span class="fl">0.1</span>)),<span class="kw">log</span>(<span class="kw">exp</span>(<span class="fl">0.1</span>)))); <span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">exp</span>(<span class="kw">log</span>(<span class="fl">0.1</span>)),<span class="fl">0.1</span>)); <span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(<span class="fl">0.1</span>)),<span class="fl">0.1</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>3.conclusion</p>
<p>The identity <span class="math inline">\(log(e^x) = e^{log(x)}=x\)</span> does not hold exactly in computer arithmetic, however, it holds with near equality.</p>
</div>
<div id="answer-of-11.5" class="section level2">
<h2>Answer of 11.5</h2>
<p>1.basic ideas</p>
<p>We use function “uniroot” to calculate the roots of two equations in 11.4 and 11.5 with different values of parameter k and compare them.</p>
<p>2.code</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co">## answer of 11.4</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)<span class="co"># different values of parameter k (df of t distribution)</span></span>
<span id="cb78-3"><a href="#cb78-3"></a>solution1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="co"># the one-dimensional nonlinear function </span></span>
<span id="cb78-6"><a href="#cb78-6"></a>  f &lt;-<span class="st"> </span><span class="cf">function</span>(a) {<span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k[i]<span class="op">/</span>(k[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k[i])}</span>
<span id="cb78-7"><a href="#cb78-7"></a>  solution1[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="dt">lower=</span><span class="dv">0</span><span class="fl">+1e-6</span>,<span class="dt">upper=</span><span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">1e-6</span>)<span class="op">$</span>root</span>
<span id="cb78-8"><a href="#cb78-8"></a>}</span>
<span id="cb78-9"><a href="#cb78-9"></a><span class="kw">round</span>(solution1,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  [1]  1.4921  1.5335  1.5628  1.5844  1.6012  1.6145  1.6254  1.6344  1.6420
## [10]  1.6485  1.6542  1.6591  1.6634  1.6673  1.6707  1.6738  1.6766  1.6791
## [19]  1.6815  4.7958  4.8990  5.0000 10.0000 22.3607 31.6228</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co">## answer of 11.5</span></span>
<span id="cb80-2"><a href="#cb80-2"></a>k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb80-3"><a href="#cb80-3"></a>solution2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</span>
<span id="cb80-5"><a href="#cb80-5"></a><span class="co"># the upper value of integrate function</span></span>
<span id="cb80-6"><a href="#cb80-6"></a>  ck1 &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb80-7"><a href="#cb80-7"></a><span class="co"># the left function of the equation </span></span>
<span id="cb80-8"><a href="#cb80-8"></a>  g1 &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>(k[i]<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">log</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)))<span class="op">-</span><span class="kw">lgamma</span>((k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span>(<span class="kw">integrate</span>(<span class="cf">function</span>(u) {(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k[i]<span class="op">-</span><span class="dv">1</span>))<span class="op">^</span>(<span class="op">-</span>k[i]<span class="op">/</span><span class="dv">2</span>)},<span class="dt">lower =</span> <span class="fl">1e-6</span>,<span class="dt">upper =</span> <span class="kw">ck1</span>(a)<span class="op">-</span><span class="fl">1e-6</span>)<span class="op">$</span>value)</span>
<span id="cb80-9"><a href="#cb80-9"></a>  ck2 &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i])<span class="op">/</span>(k[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb80-10"><a href="#cb80-10"></a>  g2 &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k[i]<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">log</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k[i]))<span class="op">-</span><span class="kw">lgamma</span>(k[i]<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span>(<span class="kw">integrate</span>(<span class="cf">function</span>(u) {(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k[i]))<span class="op">^</span>(<span class="op">-</span>(k[i]<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)},<span class="dt">lower =</span> <span class="fl">1e-6</span>,<span class="dt">upper =</span> <span class="kw">ck2</span>(a)<span class="op">-</span><span class="fl">1e-6</span>)<span class="op">$</span>value)</span>
<span id="cb80-11"><a href="#cb80-11"></a></span>
<span id="cb80-12"><a href="#cb80-12"></a>  <span class="co"># the one-dimensional nonlinear function</span></span>
<span id="cb80-13"><a href="#cb80-13"></a>  f &lt;-<span class="st"> </span><span class="cf">function</span>(a) {<span class="kw">g1</span>(a)<span class="op">-</span><span class="kw">g2</span>(a)}</span>
<span id="cb80-14"><a href="#cb80-14"></a>  solution2[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="dt">lower=</span><span class="dv">0</span><span class="fl">+1e-2</span>,<span class="dt">upper=</span><span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">1e-2</span>)<span class="op">$</span>root</span>
<span id="cb80-15"><a href="#cb80-15"></a>}</span>
<span id="cb80-16"><a href="#cb80-16"></a><span class="kw">round</span>(solution2,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  [1] 1.4921 1.5336 1.5627 1.5844 1.6012 1.6145 1.6254 1.6344 1.6420 1.6486
## [11] 1.6542 1.6591 1.6635 1.6673 1.6707 1.6738 1.6766 1.6791 1.6815 1.6836
## [21] 1.6855 1.6874 1.7206 1.7297 1.7309</code></pre>
<p>3.my thoughts</p>
<p>We can find that when k is not large, the roots of the two equantions in 11.4 and 11.5 are the same, however, when k is larger than 22, the roots of 11.4 are wrong, which is because computer can not calculate numbers too large.</p>
<p>As a result, we can use <span class="math inline">\(exp(log(x))=x\)</span> to calculate the ratio of two large numbers and improve the algorithm of 11.5 to get the true answers.</p>
</div>
<div id="answer-of-ex-1" class="section level2">
<h2>Answer of Ex</h2>
<p>1.basic ideas</p>
<p>We use the EM (Expectation–Maximization) algorithm to ﬁnd maximum likelihood estimates when data are incomplete.</p>
<p>2.code</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">library</span>(<span class="st">&quot;stats4&quot;</span>)</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="co">## the log likelihood function</span></span>
<span id="cb82-3"><a href="#cb82-3"></a>ll &lt;-<span class="st"> </span><span class="cf">function</span>(p,nAA,nBB) <span class="op">-</span>{nAA<span class="op">*</span><span class="kw">log</span>(p[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>nBB<span class="op">*</span><span class="kw">log</span>(p[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="dv">41</span><span class="op">*</span><span class="kw">log</span>((<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>])<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>(<span class="dv">28</span><span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>]))<span class="op">+</span>(<span class="dv">24</span><span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>]))<span class="op">+</span><span class="dv">70</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[<span class="dv">1</span>]<span class="op">*</span>p[<span class="dv">2</span>])}</span>
<span id="cb82-4"><a href="#cb82-4"></a>tol &lt;-<span class="st"> </span><span class="fl">1e-10</span><span class="co"># convergence condition</span></span>
<span id="cb82-5"><a href="#cb82-5"></a>N &lt;-<span class="st"> </span><span class="dv">100</span><span class="co"># max numbers of iterations</span></span>
<span id="cb82-6"><a href="#cb82-6"></a>lmlv &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)<span class="co"># log-maximum likelihood values</span></span>
<span id="cb82-7"><a href="#cb82-7"></a>p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>)<span class="co"># initial estimate of the target parameter</span></span>
<span id="cb82-8"><a href="#cb82-8"></a>par &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span> N ,<span class="dt">ncol =</span> <span class="dv">2</span>); par[<span class="dv">1</span>,] &lt;-<span class="st"> </span>p</span>
<span id="cb82-9"><a href="#cb82-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb82-10"><a href="#cb82-10"></a>  <span class="co"># the E step</span></span>
<span id="cb82-11"><a href="#cb82-11"></a>  nAA &lt;-<span class="st"> </span><span class="dv">28</span><span class="op">*</span>p[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>]))</span>
<span id="cb82-12"><a href="#cb82-12"></a>  nBB &lt;-<span class="st"> </span><span class="dv">24</span><span class="op">*</span>p[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>]))</span>
<span id="cb82-13"><a href="#cb82-13"></a>  lmlv[i]&lt;-<span class="kw">ll</span>(p,nAA,nBB)</span>
<span id="cb82-14"><a href="#cb82-14"></a>  <span class="co"># the M step</span></span>
<span id="cb82-15"><a href="#cb82-15"></a>  par[i<span class="op">+</span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">par=</span>p,<span class="dt">fn=</span>ll,<span class="dt">nAA=</span>nAA,<span class="dt">nBB=</span>nBB)<span class="op">$</span>par</span>
<span id="cb82-16"><a href="#cb82-16"></a>  p &lt;-<span class="st"> </span>par[i<span class="op">+</span><span class="dv">1</span>,]</span>
<span id="cb82-17"><a href="#cb82-17"></a>  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(par[i<span class="op">+</span><span class="dv">1</span>,]<span class="op">-</span>par[i,])) <span class="op">&lt;</span><span class="st"> </span>tol) <span class="cf">break</span></span>
<span id="cb82-18"><a href="#cb82-18"></a>}</span>
<span id="cb82-19"><a href="#cb82-19"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">p_mle=</span>p[<span class="dv">1</span>],<span class="dt">q_mle=</span>p[<span class="dv">2</span>]),<span class="dv">5</span>))<span class="co"># MLE of p and q</span></span></code></pre></div>
<pre><code>##   p_mle   q_mle 
## 0.32735 0.31040</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>index &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>i)</span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="kw">plot</span>(index,<span class="op">-</span>lmlv[index],<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;log-maximum likelihood values&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;iteration numbers&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.my thoughts</p>
<p>The MLE of p is 0.32735 and the MLE of q is 0.31040 by EM algorithm and we can find that the log-maximum likelihood values in M-steps are increasing via the line plot.</p>
<div id="homework-of-20191213" class="section level3">
<h3>Homework of 20191213</h3>
</div>
<div id="exercises" class="section level3">
<h3>11.1.2 Exercises</h3>
</div>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Use both for loops and lapply() to ﬁt linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt)</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb85-2"><a href="#cb85-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>( mpg <span class="op">~</span><span class="st"> </span>disp, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</span>
<span id="cb85-3"><a href="#cb85-3"></a></span>
<span id="cb85-4"><a href="#cb85-4"></a><span class="co">## for loops</span></span>
<span id="cb85-5"><a href="#cb85-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){</span>
<span id="cb85-6"><a href="#cb85-6"></a>  <span class="kw">print</span>(<span class="kw">lm</span>(formulas[[i]]))</span>
<span id="cb85-7"><a href="#cb85-7"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="co">## lapply</span></span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="kw">lapply</span>(formulas, lm)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">detach</span>(mtcars)</span></code></pre></div>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loops and lapply().</p>
<p>Can you do it without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) {</p>
<p>rows &lt;- sample(1:nrow(mtcars), rep = TRUE)</p>
<p>mtcars[rows, ]</p>
<p>})</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb90-2"><a href="#cb90-2"></a>  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb90-3"><a href="#cb90-3"></a>  mtcars[rows, ]</span>
<span id="cb90-4"><a href="#cb90-4"></a>  })</span>
<span id="cb90-5"><a href="#cb90-5"></a><span class="co">## with an anonymous function</span></span>
<span id="cb90-6"><a href="#cb90-6"></a><span class="co"># usefor loops</span></span>
<span id="cb90-7"><a href="#cb90-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){</span>
<span id="cb90-8"><a href="#cb90-8"></a>  <span class="kw">print</span>(<span class="kw">lm</span>(bootstraps[[i]]<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>bootstraps[[i]]<span class="op">$</span>disp))</span>
<span id="cb90-9"><a href="#cb90-9"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.29223              -0.04465  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             34.14296              -0.05453  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.50452              -0.03772  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.97980              -0.04506  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.08707              -0.03728  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.08445              -0.03677  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.78421              -0.04174  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.25270              -0.04112  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.26285              -0.03998  
## 
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.69886              -0.04057</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="co"># use lapply</span></span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.29223     -0.04465  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    34.14296     -0.05453  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.50452     -0.03772  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.97980     -0.04506  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.08707     -0.03728  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.08445     -0.03677  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.78421     -0.04174  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.25270     -0.04112  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.26285     -0.03998  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.69886     -0.04057</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co">## use lapply without an anonymous function</span></span>
<span id="cb94-2"><a href="#cb94-2"></a>fit &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb94-3"><a href="#cb94-3"></a>  <span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp,<span class="dt">data=</span>x)</span>
<span id="cb94-4"><a href="#cb94-4"></a>}</span>
<span id="cb94-5"><a href="#cb94-5"></a><span class="kw">lapply</span>(bootstraps, fit)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.29223     -0.04465  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    34.14296     -0.05453  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.50452     -0.03772  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.97980     -0.04506  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.08707     -0.03728  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.08445     -0.03677  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.78421     -0.04174  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.25270     -0.04112  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.26285     -0.03998  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.69886     -0.04057</code></pre>
</div>
<div id="question-5-1" class="section level2">
<h2>Question 5</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb96-2"><a href="#cb96-2"></a>rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="co">## R2 in ex3</span></span>
<span id="cb96-4"><a href="#cb96-4"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(mpg <span class="op">~</span><span class="st"> </span>disp, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</span>
<span id="cb96-5"><a href="#cb96-5"></a></span>
<span id="cb96-6"><a href="#cb96-6"></a><span class="co"># for loops</span></span>
<span id="cb96-7"><a href="#cb96-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){</span>
<span id="cb96-8"><a href="#cb96-8"></a>  <span class="kw">print</span>(<span class="kw">rsq</span>(<span class="kw">lm</span>(formulas[[i]])))</span>
<span id="cb96-9"><a href="#cb96-9"></a>}</span></code></pre></div>
<pre><code>## [1] 0.7183433
## [1] 0.8596865
## [1] 0.7809306
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="co"># lapply</span></span>
<span id="cb98-2"><a href="#cb98-2"></a><span class="kw">lapply</span>(<span class="kw">lapply</span>(formulas,lm),rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co">## R2 in ex4</span></span>
<span id="cb100-2"><a href="#cb100-2"></a>bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb100-3"><a href="#cb100-3"></a>  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb100-4"><a href="#cb100-4"></a>  mtcars[rows, ]</span>
<span id="cb100-5"><a href="#cb100-5"></a>  })</span>
<span id="cb100-6"><a href="#cb100-6"></a></span>
<span id="cb100-7"><a href="#cb100-7"></a><span class="co"># for loops</span></span>
<span id="cb100-8"><a href="#cb100-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){</span>
<span id="cb100-9"><a href="#cb100-9"></a>  <span class="kw">print</span>(<span class="kw">rsq</span>(<span class="kw">lm</span>(bootstraps[[i]]<span class="op">$</span>mpg <span class="op">~</span><span class="st"> </span>bootstraps[[i]]<span class="op">$</span>disp)))</span>
<span id="cb100-10"><a href="#cb100-10"></a>}</span></code></pre></div>
<pre><code>## [1] 0.627387
## [1] 0.6173572
## [1] 0.7186893
## [1] 0.7591539
## [1] 0.7737098
## [1] 0.6821303
## [1] 0.7075114
## [1] 0.7445228
## [1] 0.7903234
## [1] 0.8316293</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="co"># lapply</span></span>
<span id="cb102-2"><a href="#cb102-2"></a><span class="kw">lapply</span>(<span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp),rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.627387
## 
## [[2]]
## [1] 0.6173572
## 
## [[3]]
## [1] 0.7186893
## 
## [[4]]
## [1] 0.7591539
## 
## [[5]]
## [1] 0.7737098
## 
## [[6]]
## [1] 0.6821303
## 
## [[7]]
## [1] 0.7075114
## 
## [[8]]
## [1] 0.7445228
## 
## [[9]]
## [1] 0.7903234
## 
## [[10]]
## [1] 0.8316293</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="kw">detach</span>(mtcars)</span></code></pre></div>
<div id="exercises-1" class="section level3">
<h3>11.2.5 Exercises</h3>
</div>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb105-2"><a href="#cb105-2"></a>  <span class="dv">100</span>,</span>
<span id="cb105-3"><a href="#cb105-3"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb105-4"><a href="#cb105-4"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb105-5"><a href="#cb105-5"></a>)</span>
<span id="cb105-6"><a href="#cb105-6"></a><span class="co">## use sapply() and an anonymous function</span></span>
<span id="cb105-7"><a href="#cb105-7"></a>pvalue &lt;-<span class="st"> </span><span class="cf">function</span>(test) test<span class="op">$</span>p.value</span>
<span id="cb105-8"><a href="#cb105-8"></a><span class="kw">sapply</span>(trials, pvalue)</span></code></pre></div>
<pre><code>##   [1] 0.22377671 0.24763927 0.01438627 0.69157329 0.59883295 0.04555849
##   [7] 0.93426874 0.14333515 0.48433394 0.56727257 0.16640436 0.18652755
##  [13] 0.02142283 0.34981685 0.47286482 0.95938630 0.76512377 0.98289770
##  [19] 0.12105962 0.25669566 0.35738533 0.85925693 0.09992864 0.11984044
##  [25] 0.37322131 0.92766067 0.02592482 0.44237456 0.36437873 0.77801711
##  [31] 0.67509121 0.65220766 0.33995575 0.48591313 0.40503901 0.83179741
##  [37] 0.58305095 0.97369711 0.19018270 0.48190877 0.32417565 0.07426498
##  [43] 0.82364655 0.61930939 0.42796924 0.14036646 0.50756821 0.18134870
##  [49] 0.91735921 0.97446396 0.95183267 0.70785802 0.29386010 0.89796022
##  [55] 0.72984170 0.24104605 0.03369810 0.79595781 0.77393948 0.11578829
##  [61] 0.54481210 0.35602570 0.61323133 0.39353106 0.91061811 0.74110771
##  [67] 0.79043321 0.48737433 0.75329088 0.96939136 0.80779478 0.69231919
##  [73] 0.13412317 0.76366761 0.10313856 0.16427307 0.40088189 0.17936957
##  [79] 0.94846194 0.36646866 0.13661472 0.90871379 0.95197544 0.53175214
##  [85] 0.90005722 0.26181500 0.33184916 0.31868724 0.11470173 0.60707926
##  [91] 0.48800430 0.03196330 0.08967491 0.21092119 0.13273251 0.70118774
##  [97] 0.72314111 0.06622198 0.85260450 0.89149844</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="co">## use [[ directly</span></span>
<span id="cb107-2"><a href="#cb107-2"></a><span class="kw">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   [1] 0.22377671 0.24763927 0.01438627 0.69157329 0.59883295 0.04555849
##   [7] 0.93426874 0.14333515 0.48433394 0.56727257 0.16640436 0.18652755
##  [13] 0.02142283 0.34981685 0.47286482 0.95938630 0.76512377 0.98289770
##  [19] 0.12105962 0.25669566 0.35738533 0.85925693 0.09992864 0.11984044
##  [25] 0.37322131 0.92766067 0.02592482 0.44237456 0.36437873 0.77801711
##  [31] 0.67509121 0.65220766 0.33995575 0.48591313 0.40503901 0.83179741
##  [37] 0.58305095 0.97369711 0.19018270 0.48190877 0.32417565 0.07426498
##  [43] 0.82364655 0.61930939 0.42796924 0.14036646 0.50756821 0.18134870
##  [49] 0.91735921 0.97446396 0.95183267 0.70785802 0.29386010 0.89796022
##  [55] 0.72984170 0.24104605 0.03369810 0.79595781 0.77393948 0.11578829
##  [61] 0.54481210 0.35602570 0.61323133 0.39353106 0.91061811 0.74110771
##  [67] 0.79043321 0.48737433 0.75329088 0.96939136 0.80779478 0.69231919
##  [73] 0.13412317 0.76366761 0.10313856 0.16427307 0.40088189 0.17936957
##  [79] 0.94846194 0.36646866 0.13661472 0.90871379 0.95197544 0.53175214
##  [85] 0.90005722 0.26181500 0.33184916 0.31868724 0.11470173 0.60707926
##  [91] 0.48800430 0.03196330 0.08967491 0.21092119 0.13273251 0.70118774
##  [97] 0.72314111 0.06622198 0.85260450 0.89149844</code></pre>
</div>
<div id="question-7-1" class="section level2">
<h2>Question 7</h2>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="kw">library</span>(parallel)</span>
<span id="cb109-2"><a href="#cb109-2"></a>cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(<span class="kw">getOption</span>(<span class="st">&quot;cl.cores&quot;</span>, <span class="dv">2</span>))</span>
<span id="cb109-3"><a href="#cb109-3"></a></span>
<span id="cb109-4"><a href="#cb109-4"></a>bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100000</span>, <span class="cf">function</span>(i) {</span>
<span id="cb109-5"><a href="#cb109-5"></a>  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</span>
<span id="cb109-6"><a href="#cb109-6"></a>  mtcars[rows, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb109-7"><a href="#cb109-7"></a>})</span>
<span id="cb109-8"><a href="#cb109-8"></a><span class="co">## for sapply()</span></span>
<span id="cb109-9"><a href="#cb109-9"></a><span class="kw">system.time</span>(<span class="kw">sapply</span>(bootstraps, lm))</span></code></pre></div>
<pre><code>##  用户  系统  流逝 
## 55.80  0.42 56.26</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="co">## for parSapply</span></span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="kw">parSapply</span>(cl, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, sqrt)</span></code></pre></div>
<pre><code>##  [1] 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751 2.828427
##  [9] 3.000000 3.162278</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="kw">system.time</span>(<span class="kw">parSapply</span>(cl,bootstraps, lm))</span></code></pre></div>
<pre><code>##  用户  系统  流逝 
##  8.91  1.36 55.49</code></pre>
</div>
<div id="my-thoughts" class="section level2">
<h2>My thoughts</h2>
<p>Since we can compute each element in any order, it’s easy to dispatch the tasks to different cores, and compute them in parallel, so we can use parSapply.</p>
<p>However, there is no direct way to use a multicore version of vapply(), I guess it’s because vapply() need to set a pre-specified type of return value, which can not be computed in parallel.</p>
<div id="homework-of-20191220" class="section level3">
<h3>Homework of 20191220</h3>
</div>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task.</p>
<p>Compare the generated random numbers by the two functions using qqplot.</p>
<p>Campare the computation time of the two functions with microbenchmark.</p>
<p>Comments your results.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb115-2"><a href="#cb115-2"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb115-3"><a href="#cb115-3"></a><span class="kw">set.seed</span>(<span class="dv">135</span>)</span>
<span id="cb115-4"><a href="#cb115-4"></a></span>
<span id="cb115-5"><a href="#cb115-5"></a><span class="co">## random walk Metropolis sampler in R</span></span>
<span id="cb115-6"><a href="#cb115-6"></a>rwMetropolisR &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb115-7"><a href="#cb115-7"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb115-8"><a href="#cb115-8"></a>  x[<span class="dv">0</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb115-9"><a href="#cb115-9"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb115-10"><a href="#cb115-10"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb115-11"><a href="#cb115-11"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb115-12"><a href="#cb115-12"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb115-13"><a href="#cb115-13"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y))) <span class="op">/</span><span class="st"> </span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))))</span>
<span id="cb115-14"><a href="#cb115-14"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb115-15"><a href="#cb115-15"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb115-16"><a href="#cb115-16"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb115-17"><a href="#cb115-17"></a>      }</span>
<span id="cb115-18"><a href="#cb115-18"></a>  }</span>
<span id="cb115-19"><a href="#cb115-19"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb115-20"><a href="#cb115-20"></a>}</span>
<span id="cb115-21"><a href="#cb115-21"></a></span>
<span id="cb115-22"><a href="#cb115-22"></a><span class="co">## random walk Metropolis sampler in C++</span></span>
<span id="cb115-23"><a href="#cb115-23"></a><span class="kw">cppFunction</span>(<span class="st">&#39;List rwMetropolisC(double sigma, double x0, int N) {</span></span>
<span id="cb115-24"><a href="#cb115-24"></a><span class="st">            NumericVector x(N);</span></span>
<span id="cb115-25"><a href="#cb115-25"></a><span class="st">            x[0] = x0;</span></span>
<span id="cb115-26"><a href="#cb115-26"></a><span class="st">            int k = 0;</span></span>
<span id="cb115-27"><a href="#cb115-27"></a><span class="st">            for(int i = 1; i &lt; N; i++){</span></span>
<span id="cb115-28"><a href="#cb115-28"></a><span class="st">              double u = as&lt;double&gt;(runif(1));</span></span>
<span id="cb115-29"><a href="#cb115-29"></a><span class="st">              double y = as&lt;double&gt;(rnorm(1, x[i-1], sigma));</span></span>
<span id="cb115-30"><a href="#cb115-30"></a><span class="st">              if(u &lt;= exp(-abs(y)+abs(x[i-1]))) </span></span>
<span id="cb115-31"><a href="#cb115-31"></a><span class="st">              x[i] = y;</span></span>
<span id="cb115-32"><a href="#cb115-32"></a><span class="st">              else {</span></span>
<span id="cb115-33"><a href="#cb115-33"></a><span class="st">                x[i] = x[i-1];</span></span>
<span id="cb115-34"><a href="#cb115-34"></a><span class="st">                k += 1;</span></span>
<span id="cb115-35"><a href="#cb115-35"></a><span class="st">              }</span></span>
<span id="cb115-36"><a href="#cb115-36"></a><span class="st">            }</span></span>
<span id="cb115-37"><a href="#cb115-37"></a><span class="st">            return List::create(x,k);</span></span>
<span id="cb115-38"><a href="#cb115-38"></a><span class="st">          }&#39;</span>)</span>
<span id="cb115-39"><a href="#cb115-39"></a></span>
<span id="cb115-40"><a href="#cb115-40"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span>; sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>); x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb115-41"><a href="#cb115-41"></a></span>
<span id="cb115-42"><a href="#cb115-42"></a><span class="co"># plots of four chains in C++</span></span>
<span id="cb115-43"><a href="#cb115-43"></a>index &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>; refline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span><span class="fl">0.025</span>), <span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="fl">-0.975</span>)))</span>
<span id="cb115-44"><a href="#cb115-44"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb115-45"><a href="#cb115-45"></a>  y &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">rwMetropolisC</span>(sigma[i], x0, N)[<span class="dv">1</span>])</span>
<span id="cb115-46"><a href="#cb115-46"></a>  <span class="kw">plot</span>(index, y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb115-47"><a href="#cb115-47"></a>  <span class="kw">abline</span>(<span class="dt">h =</span> refline, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">2</span>)</span>
<span id="cb115-48"><a href="#cb115-48"></a>  <span class="kw">title</span>(<span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>, sigma[i]))</span>
<span id="cb115-49"><a href="#cb115-49"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOpBmZmZmkLZmtrZmtttmtv+QOgCQOmaQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb2//b/9vb////AAD/tmb/25D/27b//7b//9v////vMoVnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJiklEQVR4nO2dC3vbthWG4dSZ1brdWruXbbG3dp2VLY2SdPPkWPz//2sAAYIASfAjKZA8sr73eeLoAhySrw8ulCFSFaQXtfYOSIeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCrCrocK9ePx5R/a1SF3+pA+xUyVWGPas5YUG6duxj++IEHcdOXfxafFDqzj1/vlU3+beyhqAP17pp/OmdzyDTVC4fturVe32MV5+u1cWb4sNGv2QKf/pBJ8U3+uHTxiaIuihfN5Wvqp8lusBdapPTWUGQ6ypevXeCbFO5uLaCLNeuRLH3UpqCXMJsfSvVRb/WLt/l3dvlBZkseSw+Kn14VpA+sKvHw1Y5QTfmPfXGeCxL/OHRuLlpCSpfNIKMx6LwXZB7OxfLC9IHdvlv+9AKsoeo3ZSC9Av2pxNQFL//67qr520KOvy8uXxXfNocNTC2WV6QbVFfmOG5FFQNZVUfZHOsEnD4OTU0tTLIssucQiv0QZ9/sE3hn1aQ1ZEQZGxe/uN38wJsYpb96QvSin4xnbBLnt4MshaeuwS1OmnLixCkOfxd++jqg2JB+3Ka09lJ+yHQtb6nHzddGXUsywvSx/zdo2lnVfLEo1grg14/fr7vnB7vyvmSMVhlop44ftyc/kz6rU+ErnlQuw9KnT/Upxo2jkuxvIPYKk3so+mBvoln0n98lx7FLn/ddbabw9uNPVl1cT7/qD1/m9ePoHOxZm8rBAGCdO/zbZkweTuPTAgQtI9HJ2EIEKT7jo07vReIBEGioSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEyC1Inw1qC8oabDwoCzCLo+dYsIzXLeZILSSmo2JmFcs+3ie/VqPFR12E2QU7NLrGekIKeNqWgfaKRURAzqAf7dberouqu0+GGTzPWYq5hXju6eNADWerLoWcvaFg4Jb+NLSyoMYM/X0Hm+7i2k+4fxc5V0E73P8+3ppeGgqT3QrMIOtzflD/1EE9BXVQnGNvXjxTUhc0gzfaKgjqptJTfL+0Pd56C9ChmG9nhnoKO3C4FgXAUhMIJN7S+IOGTaQoCUBCAggAUBFj386CMkeeCGQSgIAAFASQIEm1IgCDZhigIQEEACYJEd9PzrQ8asYDqPAUNWkA1PvbSrLz8ZXzspZlN0LAFVONjLw0zCDCToKELqMbHXpq5hvmBC6jcE8GGRMyDJKeQgA/MCtEpJCSDKKg/3LkJ8ne9SJ9snLeg9KKORDjBq4RmamKHe3BJ45YgqYbm6oP24PY5Zy9oZLiXJOjwnxm2+5IE2fXPWtTfjrktRVOQ2Mn0hCZmb2nSff+B6dtVQk84pvRB9j4Vx93krS1IaBJN6qSNoSPv8dYhSGY3NEXQVqk3x9228kULcjdb2mfug6QamiDoJ5s6WUex4gUJmnG7FJT6wCzrNvLCDALIEiSwF6IgAAUBKAggSpDEz6ZlCRI4jlEQgIIA0gSJM0RBAGGC5LUxCgLM9Lf5yddRPCNBI5YBT93OEswmaMwizqnbWYLZBHUvA8YX2VXJJ2P3Ig+yM6hZatos4CirMwkatww4+cZLFVSMXAYcv6GSpab94eO4yae0eVAkoXloFFT0Chp1BfWw2vg6Qe3sBYfxv5NhJUETM6hRD+2UKvu0ASk0cNoBtpWTdLhIkGq+E73SPixV/bD/XqSg4L1Gwpij6BakqufKl6ueuif9uz904tobY2jB48NVHpotqk+Q8kYSgtJts8zL+GorwTORgtR0QdV/3YKC3Cx8Uyw3EwlSpyKoKuZbUONAVdUII0H16Z5yHVBUrw5QvxW3wRMRpKL9L/yRqSIU5Jy4Drx+0iXI5ZUXUBeJUlOdgCBVJ1F97q/qmt5Y5UR1Cgr7Jh8nCBh+tlC357ghSxRUBIJUcGBVTdUUFCZM4YUpPwzWZYL3Yj9Bu/K5Nu648wiK9gmVKroF+dq1IN/YfGE3CapKqlCHS5ZGDRmChoXzCTRMkKoExYcZCir6BPmw7kGwMcmC/KNGL1onYCQoLOo3EQiKDBVRz+7D+i0G+ydSUDDAtwXV+ur+txYUT5Si3jboh+IRvora8DVkRwcf0WgGhvO/1khQUUS/5SBNmpGDJ3UGFqGgumTQnE9HkO+KGiNvcChFM2l6I4UxosJBe3XFI+0D9nRowVnCNT+IzS/IFommi+N2dF1BjcMLx7JpETq/WxTm6dkL6qodN+STFzQyRqs1DauwlqC1P2kezhyCZrhLZrP8yPY1fQdmyaBjVncM3Z2TFzT1b/NLsbqgMRd5k8zZZtBQZhJkZinTVndIY65hPrG6I/jE4URYbaJ4MswoyN+H7eigQz8cWaPYxOIGCgJQEICCABR0NBSUKSgF5SlHQRKLTSx+flAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAfkF7VV65O0H9x0dfrr9CH09fvc8dskV2QXvzh8X03j19+dAoByr08HxbrhDIGbJNbkH2A+tt8vYb1aoHXw5VSLN365QyhuwgtyC7+mOXXGG1u2qUQxWS7NWNVZMvZBfZBZX5nlodo3+vX6vyuvm+HKrQh62VNWSL3IJs0092AM+3Zt3M9qYuByr0b8w4yBuyxcKCXKFX7/MJyhuyxdJNzBba3GVsYllDtli6k7aFvnzI0qOGgjKFbLHwMG/3XR9YljG5FJQ3ZIulJ4rlbuseNcuszo1iOUO2yH+qseuf5m+Vu/2LLwcq9OCaWM6QLXiyCqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBxAlqXx4t1zKEaYgT1IaCABQUYZrY8+1fb+2KFrOO5RcjaGdXspplY8nrg82CUEHayU7/22ofe+WePG1uysVjqQvMzYNQQTd2WWa5um578eCuAWp0vfrt+0VbnFBBd+UDu4LML+wtfW1VnrWHQxEtaOcFuSuz3ZlvICSukjoTogU1MshwuP9znuW9QxEtyC14Nn1QlTa71/+FF8DKimhB5eDlRzHbW9/lWkI/ENmC4nmQFrPVQ/zhfsluWpwgaVAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYD/A/d7FiEfQwx7AAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOpBmZmZmkLZmtrZmtttmtv+QOgCQOmaQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb2//b/9vb////AAD/tmb/25D/27b//7b//9v////vMoVnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI3klEQVR4nO2dC3ubNhSGlSxZ3GVdO3vdrfG2bgtru9DL5jmx+f//axLiIkDiA1sYGb73eZo4WBzQmyMJuydYJKQVMfYJhA4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEGFvQfi2uN0dFiPIAH2+FuHrv46RMzl3Q/i+RBZAPJBf3nk4sZ2xBR/LplcgEbYV4nTwuLpaejzCSoA9yOFy8eF9kkEqEq/tIXD7sVuLm0624eJ18WMhNqnFq4bl8+LgQopInsXy40IKiY4eqg3EExbqflw+ZIPlVdftWC9LcZi1UbmRSLIKu3mnDcrcvpeQX3iWNIkhlySb5KMQyEyQd3Gz2kcgELdVzcsTEWYsvN8rNsinow8tNloL5U8qoV0YRJHtz9U4/1P2L0o5JN6kguUF/Ta0oPr+V+XRjjWUIWmrnfhlFkB5RX/y0yfqXL2X5HKRzLMkE7X/TyYEEFQPWK+PMQU+v9Ej5U3dJ63AIUjavfv+sNjSGWGIKUt8i72NsrGX+6c1tukDjDNJptAOC9JickCDJ/lfZG9scVBUkJ/C7xDFJJ+V1wjoN4X+xH0WQ7PO3GzXO8uSprmKNDLrePK3BHKRDfFpMY5LOXhaoRLBdBzXnIDxJq+QR+VW1T0YaYuqFpXhevZL+5r17Fbv6I3bMLoWg/Vs5AF9O40LRxVAvF44hDEFyeLxME8Y+jMYkDEHb5uoUCmEISp6+X2Qv70MjEEHhQkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIEAfQbuVKp3YDlEJGC69BcW6XOlusDMKjL6CMjVxeFUGA9FX0OMiFbSdzSDznEHibBhGkIp8k+TT9ZHhRmUQQUnq6OJeLmSuSsDZCzpxuOE4saDa0D4DTQMJUn+loydpxyo2c0GxnH92KzVLU5CN/XqZfpVLPAXZyF9gRNcbCrKhM0gS3VCQlVxL+lcnLeFmK0iuYnqQ7dcUdMxxKQiEoyAQjoJAOApC4cI3REEACgJQEICCAOO+YUZBKBwFgXAUBMJREAhHQSAcBYFwFATCURAIN1NBHSrMKAhUmFEQqg/qH3UcBhMEKswoiBnUQvcKs5kKSjpXmM1XUMdwFFSPwjfM+oWjIBBupoKKm4W7X2zMW5C76qUebq6CpCFwJ8i5C5JXQO1/BzV7QR3DURAIR0EgHAWBcBQEwlEQCEdBINwUBe3/8XjcKQrSf+YkRf1yzN8zT1iQvEhWN0x3ffhAv3CTFJR9gMVBH9wxkzfMlKEjbzkxaUGREK+P/fipCQvarYT+n3fOQfaGux906nAVO7Bhr3AUBMJREAhHQSAcBYFwFATCURAIR0Eg3EwFscoVwCpXwEA1it3vSOeRwQTZq1yPej9oWoKYQS0MVOU6HUHJMFWunQX5FBnodZB1+ykENXadoqCWdpZnRHuDOQsSlkMFI+i/s2EkQdUMavzOR8yg2s5hDDEKcoWjIBBOfbPd99shSNSesqsQomjsOKz5Q7Ep3SNIQempmf1x3Ci9nyDrGVci1wWpHYMVJHoKyr42ultsLXtaMWoasAgSAQoSFUGN4WE8tgoSTQ91QWa0SrzqfmcnSG8xf+MHCkpqgqorQ354kQsSwh62W4984RSkN5UdsQkSFUFZdwx5hqDatGIXlEctMshodmJBljfMhDC3loKyQ4rSZbFnRVAxyyeVrUbUxMzHYoyJdkG9+z1UBgmRJEW/hWHLJihJEosgI4uyrMl7KpIikCmokqRGXpZzUH2i6t4jX5S9TgpB5ZPGbGMVJAoV1clIGGR9zg9WajedCcNcErSg6pPVTCjzq7ZRGILKbCgSpDyKOaqT8hfQmGrOTFC1eS6o3K3yoE1Q4+Cu+bc0Xj/Rzj3yRbWDWFCRA6LSoDrbi0JQPWI9mnkOtQMHJkh0E1TMtzVBhumpCjK/FU86umcTVD4ljH+dBNmfOAdBbTuVa079qdoF4EFnNV1BydQEjf1Oc3eGENSj/EVUfvR4DgdzigzqUf4yX0EdixfmK6jfTd5mKKhf+UtAgg49Zj9B6pq2z8eIzkxQ4ix/Md6NOCb6CRn5QnGg6B4ZUlDxQXU4HAV5CDcOFASgIAAFAUZbxc6GkQT1C9qx3SjNDmzuNygF+WlHQSE2O7C536AU5KcdBYXY7MDmfoNSkJ920xM0JSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDAv6CtSO/c7aAsoSnate/QxuNXD75DNvAuaKvKY9xn9/jsvtYO7NDCbpXWufkM2cS3IP3frpHzQ6Ty2r2iHdrBzTartvUY0oJvQbqGMXbWCcc3tXZoBydbsdRq/IW04V1Qmu+uGk/5e/1apPfNL9qhHdrQe3kN2cC3ID30nRPAbqWqP6Nl2Q7s0H4w5cBvyAYnFpQ1unzwJ8hvyAanHmK60eLO4xDzGrLBqSdp3ejZvZcZ1RTkKWSDEy/z+txlx7ysyakgvyEbnPpCMT1tOaN6uarLVjGfIRv4f6kRt1/mRyL7+JeiHdihhWyI+QzZgC9WARQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAcIKaN/n0VYZwGMEJakJBAAqqoIbYbvXzSle0qDqWN0pQrCtZVdmY8y6XgxCoIOkklv8i6WMrsh8eF8u0eMx1m9RhCFTQUpdlptV10cV9didrpevy7+9OOuICFXSXPtAVZEVhb+orEn5qD7sStKC4EJTdme1O/QWC417fAxG0oFoGKfbrH/2U93YlaEFZwbOag/K0ia//bbmN4wAELShdvIpVTM/Wd75K6DsStqDqdZAUE8klfr8+5TQdnKDQoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8DAx873swGceYAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="co"># acceptance rates in C++</span></span>
<span id="cb116-2"><a href="#cb116-2"></a>acceptRateC &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb116-3"><a href="#cb116-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb116-4"><a href="#cb116-4"></a>  acceptRateC[i] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>(<span class="kw">as.numeric</span>(<span class="kw">rwMetropolisR</span>(sigma[i], x0, N)[<span class="dv">2</span>]))<span class="op">/</span>N</span>
<span id="cb116-5"><a href="#cb116-5"></a>}</span>
<span id="cb116-6"><a href="#cb116-6"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="dt">acceptRateC1 =</span> acceptRateC[<span class="dv">1</span>], <span class="dt">acceptRateC2 =</span> acceptRateC[<span class="dv">2</span>], <span class="dt">acceptRateC3 =</span> acceptRateC[<span class="dv">3</span>], <span class="dt">acceptRateC4 =</span> acceptRateC[<span class="dv">4</span>]))</span></code></pre></div>
<pre><code>## acceptRateC1 acceptRateC2 acceptRateC3 acceptRateC4 
##       0.9810       0.8370       0.5505       0.0825</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="co"># qqplot</span></span>
<span id="cb118-2"><a href="#cb118-2"></a>xR &lt;-<span class="st"> </span><span class="kw">rwMetropolisR</span>(<span class="dv">2</span>, <span class="dv">25</span>, <span class="dv">10000</span>)<span class="op">$</span>x[<span class="dv">1000</span><span class="op">:</span><span class="dv">10000</span>]</span>
<span id="cb118-3"><a href="#cb118-3"></a>xC &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">rwMetropolisC</span>(<span class="dv">2</span>, <span class="dv">25</span>, <span class="dv">10000</span>)[<span class="dv">1</span>])[<span class="dv">1000</span><span class="op">:</span><span class="dv">10000</span>]</span>
<span id="cb118-4"><a href="#cb118-4"></a><span class="kw">qqplot</span>(xR, xC, <span class="dt">main=</span><span class="st">&quot;qqplot&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;rwMetropolisR&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;rwMetropolisC&quot;</span>)</span>
<span id="cb118-5"><a href="#cb118-5"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="co"># computation time</span></span>
<span id="cb119-2"><a href="#cb119-2"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">xR =</span> <span class="kw">rwMetropolisR</span>(<span class="dv">2</span>, <span class="dv">25</span>, <span class="dv">10000</span>), <span class="dt">xC =</span> <span class="kw">rwMetropolisC</span>(<span class="dv">2</span>, <span class="dv">25</span>, <span class="dv">10000</span>))</span>
<span id="cb119-3"><a href="#cb119-3"></a><span class="kw">summary</span>(ts)[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr       lq    median        uq
## 1   xR 16.94840 17.463551 18.842351
## 2   xC  1.34585  1.440551  1.524801</code></pre>
</div>
<div id="comments" class="section level2">
<h2>Comments</h2>
<p>For me, it’s easier to solve this question in R because I’m not quite familiar with the usage of C and C++.</p>
<p>The results in qqplot shows that the generated random numbers are quite near with these two functions. However, the results of computation time show an evident computational speed gain of C++ against R.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
